<!DOCTYPE html>
<html lang="en">
<head>
    <title>Accessing Variables in Tasks</title>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="shortcut icon" type="image/png" href="/images/favicon.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,600,900" rel="stylesheet">
    <link rel="stylesheet" href="css/github.css">
    <link rel="stylesheet" href="css/nav.css">
    <link rel="stylesheet" href="css/sidebar.css">
    <link rel="stylesheet" href="css/style.css">
 </head>
<body>

<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="xcontainer">
        <div class="navbar-header">
            <a class="navbar-brand" title="Go to Zynk.com" href="http://zynk.com"><img class="img-responsive" id="logo-main" src="assets/logo.svg" alt="Click here to visit Zynk.com" /></a>
        </div>
        <div id="myNavbar">
                <ul class="nav navbar-nav navbar-right">
                    <li class="topnav-2"><a href="mailto:support@zynk.com">support@zynk.com</a></li>
                </ul>
        </div>
    </div>
</nav>

<div id="wrapper">

    <!-- Sidebar -->
    <div id="sidebar-wrapper" class="sidebar-nav">
        
        <h1>Zynk Workflow Documentation</h1>
<ul>
  <li><a href="index">Home</a></li>
  <li>[[Introduction]]
    <ul>
      <li>[[Welcome]]</li>
      <li>[[Getting Started]]</li>
      <li>[[Key Concepts]]</li>
      <li>[[Using Zynk]]</li>
      <li>[[Settings]]</li>
      <li>[[Extensions]]</li>
      <li>[[Integrations]]</li>
    </ul>
  </li>
  <li>[[Accounting]]
    <ul>
      <li>[[Sage 50 UK]]</li>
      <li>[[Sage 200]]</li>
      <li>[[Sage 200 Online]]</li>
      <li>[[Xero]]</li>
      <li>[[Kashflow]]</li>
      <li>[[Quickbooks Online]]</li>
      <li>[[Sage 50 US]]</li>
      <li>[[Brightpearl]]</li>
      <li>[[Sage One]]</li>
      <li>[[Sage 50 Payroll]]</li>
      <li>[[Sage 50 UK Reporting]]</li>
    </ul>
  </li>
  <li>[[CRM]]
    <ul>
      <li>[[ACT]]</li>
      <li>[[AutoTask]]</li>
      <li>[[BXP]]</li>
      <li>[[Campaign Monitor]]</li>
      <li>[[ConnectWise]]</li>
      <li>[[Salesforce]]</li>
      <li>[[Sugar CRM]]</li>
      <li>[[Zoho CRM]]</li>
    </ul>
  </li>
  <li>[[Databases]]
    <ul>
      <li>[[SQL Server]]</li>
      <li>[[SQLite]]</li>
      <li>[[ODBC]]</li>
      <li>[[OLEDB]]</li>
    </ul>
  </li>
  <li>[[Ecommerce]]
    <ul>
      <li>[[Amazon Marketplace]]</li>
      <li>[[Amazon Vendor Central]]</li>
      <li>[[BigCommerce]]</li>
      <li>[[Channel Advisor]]</li>
      <li>[[CoreCommerce]]</li>
      <li>[[Easy Webstore]]</li>
      <li>[[Ebay]]</li>
      <li>[[EKM Powershop]]</li>
      <li>[[Magento V1]]</li>
      <li>[[Magento V2]]</li>
      <li>[[PayPal]]</li>
      <li>[[Shopify]]</li>
      <li>[[WooCommerce]]</li>
    </ul>
  </li>
  <li>[[Files]]
    <ul>
      <li>[[CSV]]</li>
      <li>[[HTML]]</li>
      <li>[[Excel]]</li>
      <li>[[File]]</li>
      <li>[[File Helpers]]</li>
      <li>[[JSON]]</li>
      <li>[[PDF]]</li>
      <li>[[XML and XSLT]]</li>
    </ul>
  </li>
  <li>[[Cloud]]
    <ul>
      <li>[[Amazon S3]]</li>
    </ul>
  </li>
  <li>[[Social]]
    <ul>
      <li>[[LinkedIn]]</li>
      <li>[[Twitter]]</li>
      <li>[[Facebook]]</li>
    </ul>
  </li>
  <li>[[Web]]
    <ul>
      <li>[[Email]]</li>
      <li>[[FTP]]</li>
      <li>[[SFTP]]</li>
      <li>[[HTTP]]</li>
    </ul>
  </li>
  <li>[[Other]]
    <ul>
      <li>[[Developer]]</li>
      <li>[[SMS]]</li>
      <li>[[User Interface]]</li>
      <li>[[WordPress]]</li>
      <li>[[Zynk Core]]</li>
    </ul>
  </li>
  <li>[[Contact Us]]</li>
</ul>

    </div>
    <!-- /#sidebar-wrapper -->

    <!-- Page Content -->
    <div id="page-content-wrapper">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-12 markdown-body">
                    <a onclick="history.go(-1)" href="#"><span class="fa fa-arrow-left"></span>Back</a>
                    <h1>Accessing Variables in Tasks</h1>
                    <p>Variables can be used as the value for any task setting which accepts a <a href="zynk-object">Zynk Object</a>. Variables can also be accessed in templates. How to access the variable depends on the type of the variable:</p>

<h2 id="accessing-system-global-and-workflow-variables">Accessing System, Global and Workflow Variables</h2>
<p>You can use system, global and workflow variables for task settings using the ‘Use a variable from the list below’ option on the Zynk Object Editor. Simply select the name of the variable from the list provided, and it’s value will be used as the value for the setting.</p>

<h2 id="accessing-other-variable-types-with-razor">Accessing Other Variable Types With Razor</h2>
<p>Razor can be used to access any type of variable in Zynk (except for system variables), and it’s value can be used for a task setting or in a template. To use a variable for a task setting, you must enable the ‘Use Razor Engine’ option in the Zynk Object Editor. To access a variable with razor, reference the system Context and then choose the correct collection within that context, depending on the type of the variable.</p>

<p>Types of Variables and how to access them:-</p>

<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
      <th>Example</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td> Application</td>
      <td> A setting contained in the Global Variables collection in Zynk</td>
      <td> @Context.Application[“EmailAddress”]</td>
    </tr>
    <tr>
      <td> Workflow</td>
      <td> A setting contained in the Workflow Variables collection</td>
      <td> @Context.Workflow[“ServerPath”]</td>
    </tr>
    <tr>
      <td> Template</td>
      <td> A setting contained in the Template Variables collection</td>
      <td> @Context.Template[“CompanyName”]</td>
    </tr>
    <tr>
      <td> Current</td>
      <td> A value from the current record in a Repeater task    </td>
      <td> @Context.Current[“id”]                     </td>
    </tr>
    <tr>
      <td> Object</td>
      <td> Access to the current record in a Repeater task</td>
      <td> @Context.Object.SelectSingleNode(“Name”).InnerText</td>
    </tr>
    <tr>
      <td>(Assuming an XML Repeater Task)</td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h2 id="context-object-for-repeater-tasks">Context Object for Repeater Tasks</h2>
<p>A context object will contain a .NET object representing the current record within a repeater task. The type of the object will depend on the repeater task being used, the following table describes the different supported repeater tasks:</p>

<table>
  <thead>
    <tr>
      <th>Task</th>
      <th>Object Type</th>
      <th>Example</th>
      <th>Documentation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td> File Repeater</td>
      <td> System.IO.FileInfo</td>
      <td> @Context.Object.FullName</td>
      <td> 	<a href="http://msdn.microsoft.com/en-us/library/system.io.fileinfo.aspx">MSDN Documentation</a></td>
    </tr>
    <tr>
      <td> XML Repeater</td>
      <td> System.Xml.XmlNode</td>
      <td> @Context.Object.SelectSingleNode(“Name”).InnerText</td>
      <td> 	<a href="http://msdn.microsoft.com/en-us/library/system.xml.xmlnode.aspx">MSDN Documentation</a></td>
    </tr>
    <tr>
      <td> Excel Repeater</td>
      <td> System.Data.DataRow</td>
      <td> @Context.Object[0].ToString()</td>
      <td> 	<a href="http://msdn.microsoft.com/en-us/library/system.data.datarow.aspx">MSDN Documentation</a></td>
    </tr>
    <tr>
      <td> CSV Repeater</td>
      <td> System.Data.DataRow</td>
      <td> @Context.Object[0].ToString()</td>
      <td> 	<a href="http://msdn.microsoft.com/en-us/library/system.data.datarow.aspx">MSDN Documentation</a></td>
    </tr>
    <tr>
      <td> ODBC Repeater</td>
      <td> System.Data.DataRow</td>
      <td> @Context.Object[“NAME”].ToString()</td>
      <td> 	<a href="http://msdn.microsoft.com/en-us/library/system.data.datarow.aspx">MSDN Documentation</a></td>
    </tr>
    <tr>
      <td> OleDB Repeater</td>
      <td> System.Data.DataRow</td>
      <td> @Context.Object[0].ToString()</td>
      <td> 	<a href="http://msdn.microsoft.com/en-us/library/system.data.datarow.aspx">MSDN Documentation</a></td>
    </tr>
    <tr>
      <td> MSSQL Repeater</td>
      <td> System.Data.DataRow</td>
      <td> @Context.Object[0].ToString()</td>
      <td> 	<a href="http://msdn.microsoft.com/en-us/library/system.data.datarow.aspx">MSDN Documentation</a></td>
    </tr>
  </tbody>
</table>

<h2 id="example">Example</h2>
<p>In this example the current variables from a <a href="csv-repeater">CSV Repeater</a> task are used to dynamically set the output filename on a sub-task, based on the order numbers in this CSV file:</p>

<pre><code class="language-csv">OrderNumber,CustomerId,Total 
1250,32343,25.90 
1251,74322,129.99 
1252,87036,42.50
</code></pre>

<p>In the Zynk Object Editor for the output file setting on the sub-task, select the ‘Use the following file’ option and enter @(Context.Current[â€œOrderNumberâ€]).csv in the box below. Remember to also select the ‘Use Razor Engine’ option. This will result in the sub-task creating the following output files in the workflow’s data directory: <code class="highlighter-rouge">1250.csv</code>, <code class="highlighter-rouge">1251.csv</code>, <code class="highlighter-rouge">1252.csv</code>.</p>

<p>Please note that if you are using a period in the file name, you must encase the Razor variable in brackets eg. <code class="highlighter-rouge">@(Context.Current["OrderNumber"]).csv</code></p>

                    <hr>
                    <div class="row">
                        <div class="col-sm-6"><a onclick="history.go(-1)" href="#"><span class="fa fa-arrow-left"></span>Back</a></div>
                        <div class="col-sm-6 text-right"><a href="http://github.com/Zynk-workflow/docs/tree/master/_documentation/Using-Zynk-Section/Accessing-Variables-in-Tasks.md"><span class="fa fa-github"></span>Edit on Github</a></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- /#page-content-wrapper -->
</div>
<!-- /#wrapper -->


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<!-- Menu Toggle Script -->
<script>
    $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/js/bootstrap.min.js"></script>



<script>
    var screenWidth = $(window).width();

    // Add .active class to active link + scroll into view
    var pathinfo = location.pathname + location.hash;
    if (screenWidth > 768 && pathinfo != "/")
    {
        var scrollItem = $("#sidebar-wrapper").find("a[href='" + pathinfo + "']")
                .addClass('active')
                .parents().filter("div>ul>li")[0];
        if (scrollItem) {
            scrollItem.scrollIntoView({
                behavior: "smooth",
                block: "start"
            });
        }
    }

    // Add external link icon next to external menu links
    $(".sidebar-nav a[href^=http]")
        .append('<i class="fa fa-external-link" style="margin-left:-15px"></i>');

    $("#menu-toggle").click(function(){
        $("#sidebar-wrapper").scrollTop(0);
        $(this).toggleClass("fa-angle-down");
        $("#wrapper").toggleClass("menu-collapsed");
    });

    if (screenWidth <= 768) {
        $("#menu-toggle").click();            
    }

    //Allow clicking on non-linked headers to jump to its #href
    $("h2,h3,h4").click(function(){
        if (this.id && this.innerHTML.indexOf("<a") == -1) {
            location.href = "#" + this.id;
        }
    });

    
    
    //should no longer be needed now that we're referencing server-side /slug permalinks
(function () {
    "use strict";
    String.prototype.replaceAll = function(search, replacement) {
        var target = this;
        return target.split(search).join(replacement);
    };

    function fixDoubleBracketLinks(cssSelector) {
        var sidebarText = $(cssSelector)[0].innerHTML;
        var matches = sidebarText.match(/\[\[(.+?)\]\]/g);
        var result = sidebarText;
        if(matches != null) {
            for(var i = 0; i < matches.length; i++) {
                var text = matches[i].replaceAll('[[','').replaceAll(']]','');
                result = result.replace(matches[i],
                    '<a href="' +
                    encodeURIComponent(text.replaceAll(' ','-').toLocaleLowerCase()) +
                    '">' + text + '</a>')
            }
            $(cssSelector).html(result);
        }
    }

    fixDoubleBracketLinks('#page-content-wrapper');
    fixDoubleBracketLinks('#sidebar-wrapper');
})();
    
</script>
    
    
    
</body>
</html>
