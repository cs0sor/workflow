<!DOCTYPE html>
<html lang="en">
<head>
    <title>Exporting Custom Data from Sage 50 UK</title>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="shortcut icon" type="image/png" href="/images/favicon.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,600,900" rel="stylesheet">
    <link rel="stylesheet" href="css/github.css">
    <link rel="stylesheet" href="css/nav.css">
    <link rel="stylesheet" href="css/sidebar.css">
    <link rel="stylesheet" href="css/style.css">
 </head>
<body>

<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="xcontainer">
        <div class="navbar-header">
            <a class="navbar-brand" title="Go to Zynk.com" href="http://zynk.com"><img class="img-responsive" id="logo-main" src="assets/logo.svg" alt="Click here to visit Zynk.com" /></a>
        </div>
        <div id="myNavbar">
                <ul class="nav navbar-nav navbar-right">
                    <li class="topnav-2"><a href="mailto:support@zynk.com">support@zynk.com</a></li>
                </ul>
        </div>
    </div>
</nav>

<div id="wrapper">

    <!-- Sidebar -->
    <div id="sidebar-wrapper" class="sidebar-nav">
        
        <h1>Zynk Workflow Documentation</h1>
<ul>
  <li><a href="index">Home</a></li>
  <li>[[Introduction]]
    <ul>
      <li>[[Welcome]]</li>
      <li>[[Getting Started]]</li>
      <li>[[Key Concepts]]</li>
      <li>[[Using Zynk]]</li>
      <li>[[Settings]]</li>
      <li>[[Extensions]]</li>
      <li>[[Integrations]]</li>
    </ul>
  </li>
  <li>[[Accounting]]
    <ul>
      <li>[[Sage 50 UK]]</li>
      <li>[[Sage 200]]</li>
      <li>[[Sage 200 Online]]</li>
      <li>[[Xero]]</li>
      <li>[[Kashflow]]</li>
      <li>[[Quickbooks Online]]</li>
      <li>[[Sage 50 US]]</li>
      <li>[[Brightpearl]]</li>
      <li>[[Sage One]]</li>
      <li>[[Sage 50 Payroll]]</li>
      <li>[[Sage 50 UK Reporting]]</li>
    </ul>
  </li>
  <li>[[CRM]]
    <ul>
      <li>[[ACT]]</li>
      <li>[[AutoTask]]</li>
      <li>[[BXP]]</li>
      <li>[[Campaign Monitor]]</li>
      <li>[[ConnectWise]]</li>
      <li>[[Salesforce]]</li>
      <li>[[Sugar CRM]]</li>
      <li>[[Zoho CRM]]</li>
    </ul>
  </li>
  <li>[[Databases]]
    <ul>
      <li>[[SQL Server]]</li>
      <li>[[SQLite]]</li>
      <li>[[ODBC]]</li>
      <li>[[OLEDB]]</li>
    </ul>
  </li>
  <li>[[Ecommerce]]
    <ul>
      <li>[[Amazon Marketplace]]</li>
      <li>[[Amazon Vendor Central]]</li>
      <li>[[BigCommerce]]</li>
      <li>[[Channel Advisor]]</li>
      <li>[[CoreCommerce]]</li>
      <li>[[Easy Webstore]]</li>
      <li>[[Ebay]]</li>
      <li>[[EKM Powershop]]</li>
      <li>[[Magento V1]]</li>
      <li>[[Magento V2]]</li>
      <li>[[PayPal]]</li>
      <li>[[Shopify]]</li>
      <li>[[WooCommerce]]</li>
    </ul>
  </li>
  <li>[[Files]]
    <ul>
      <li>[[CSV]]</li>
      <li>[[HTML]]</li>
      <li>[[Excel]]</li>
      <li>[[File]]</li>
      <li>[[File Helpers]]</li>
      <li>[[JSON]]</li>
      <li>[[PDF]]</li>
      <li>[[XML and XSLT]]</li>
    </ul>
  </li>
  <li>[[Cloud]]
    <ul>
      <li>[[Amazon S3]]</li>
    </ul>
  </li>
  <li>[[Social]]
    <ul>
      <li>[[LinkedIn]]</li>
      <li>[[Twitter]]</li>
      <li>[[Facebook]]</li>
    </ul>
  </li>
  <li>[[Web]]
    <ul>
      <li>[[Email]]</li>
      <li>[[FTP]]</li>
      <li>[[SFTP]]</li>
      <li>[[HTTP]]</li>
    </ul>
  </li>
  <li>[[Other]]
    <ul>
      <li>[[Developer]]</li>
      <li>[[SMS]]</li>
      <li>[[User Interface]]</li>
      <li>[[WordPress]]</li>
      <li>[[Zynk Core]]</li>
    </ul>
  </li>
  <li>[[Contact Us]]</li>
</ul>

    </div>
    <!-- /#sidebar-wrapper -->

    <!-- Page Content -->
    <div id="page-content-wrapper">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-12 markdown-body">
                    <a onclick="history.go(-1)" href="#"><span class="fa fa-arrow-left"></span>Back</a>
                    <h1>Exporting Custom Data from Sage 50 UK</h1>
                    <p>This task will export data from Sage 50 as specified in the Query, it will export to XML format. This is useful when there is no task which exports the data required.</p>

<p>The table and column names that can be used in the Query are determined by the Sage 50 ODBC. Typically, we advise that you connect up to the Sage 50 ODBC via Excel (or some similar utility), which will give you a list of the table and column names. There is a section within the Sage Accounts Help file which details how to connect up to the Sage 50 ODBC via Excel, simply open the Sage 50 help, click ‘Index’ and search for ‘ODBC’.  You can view an extract of the document in the article <a href="using-odbc-driver-with-microsoft-office-applications">Using ODBC driver with Microsoft Office applications</a>.</p>

<h2 id="settings">Settings</h2>
<h3 id="sage-50-connection">Sage 50 Connection</h3>
<p><em>Required</em><br />
The connection to Sage 50 UK to use.  See the <a href="connecting-to-sage-50-uk">Connecting to Sage 50 UK</a> article if you require more information on how to create/manage connections.</p>

<h3 id="date-modified">Date Modified</h3>
<p><em>Dependant</em><br />
The rolling date to use when exporting modified records. Will update automatically when the task runs.</p>

<h3 id="date-modified-tables">Date Modified Tables</h3>
<p><em>Optional</em><br />
The list of tables to check for modified records in. Use when the query is joining to multiple tables, and you need to check the modified date in one or more of the tables you are joining to.</p>

<h3 id="export-as-elements">Export As Elements</h3>
<p><em>Required</em><br />
Set to true to export the data as XML elements, or false to export as XML attributes. See the samples below to see the difference between the two formats.</p>

<h3 id="export-modified-new-or-all-records">Export Modified, New or All Records</h3>
<p><em>Required</em><br />
Specify whether to export new, modified or all records from Sage. Note that the ‘Modified’ setting also includes new records.</p>

<p>This setting will only take effect when the query is specified using the ‘Select’, ‘From’, ‘Where’, ‘Group By’ and ‘Order By’ settings. When using the ‘Custom Query’ setting, the task will always return all data.</p>

<h3 id="output-file">Output File</h3>
<p><em>Required</em><br />
The name of the file to export to.</p>

<h3 id="root">Root</h3>
<p><em>Required</em><br />
The name of the XML root element, defaults to Rows</p>

<h3 id="row">Row</h3>
<p><em>Required</em><br />
The name of XML rows, defaults to Row</p>

<h3 id="custom-query">Custom Query</h3>
<p><em>Dependant</em><br />
The SQL query to run against Sage 50. This setting takes precedence over the individual ‘Select’, ‘From’, ‘Where’, ‘Group By’ and ‘Order By’ settings.  E.g.  <code class="highlighter-rouge">SELECT * FROM STOCK</code></p>

<h3 id="from">From</h3>
<p><em>Dependant</em><br />
The from statement of your SQL query. The FROM keyword should not be included. Not required when specifying the query using the Custom Query setting.  E.g.  <code class="highlighter-rouge">SALES_LEDGER</code></p>

<h3 id="group-by">Group By</h3>
<p><em>Dependant</em><br />
The group by statement of your SQL query. The GROUP BY keyword should not be  included. Not required when specifying the query using the Custom Query  setting.  E.g.  <code class="highlighter-rouge">SALES_LEDGER.ACCOUNT_REF</code></p>

<h3 id="order-by">Order By</h3>
<p><em>Dependant</em><br />
The order by statement of your SQL query. The ORDER BY keyword should not be  included. Not required when specifying the query using the Custom Query  setting.  E.g. <code class="highlighter-rouge">SALES_LEDGER.ACCOUNT_REF</code></p>

<h3 id="select">Select</h3>
<p><em>Dependant</em><br />
The select statement of your SQL query. The SELECT keyword should not be  included. Not required when specifying the query using the Custom Query  setting.  E.g. <code class="highlighter-rouge">SALES_LEDGER.ACCOUNT_REF, SALES_LEDGER.NAME, SALES_LEDGER.BALANCE</code></p>

<h3 id="where">Where</h3>
<p><em>Dependant</em><br />
The where statement of your SQL query. The WHERE keyword should not be  included. Not required when specifying the query using the Custom Query  setting.  E.g.  <code class="highlighter-rouge">SALES_LEDGER.ACCOUNT_REF = 'ABS001'</code></p>

<h3 id="zynk-settings">Zynk Settings</h3>
<p>See <a href="common-task-settings">Common Task Settings</a></p>

<h2 id="examples">Examples</h2>
<p>Example query, which selects the name and balance fields from the sales ledger, for the account ABS001:</p>

<div class="language-sql highlighter-rouge"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">ACCOUNT_REF</span><span class="p">,</span> <span class="n">NAME</span><span class="p">,</span> <span class="n">BALANCE</span> <span class="k">FROM</span> <span class="n">sales_ledger</span> <span class="k">WHERE</span> <span class="n">ACCOUNT_REF</span><span class="o">=</span><span class="s1">'ABS001'</span>
</code></pre>
</div>

<p>Example output file, when the ‘Export As Elements’ setting is false:</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" standalone="yes"?&gt;</span>
<span class="nt">&lt;Rows&gt;</span>
  <span class="nt">&lt;Row</span> <span class="na">ACCOUNT_REF=</span><span class="s">"ABS001"</span> <span class="na">NAME=</span><span class="s">"ABS Garages Ltd"</span> <span class="na">BALANCE=</span><span class="s">"2533.31"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/Rows&gt;</span>
</code></pre>
</div>

<p>Example output file, when the ‘Export As Elements’ setting is true:</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" standalone="yes"?&gt;</span>
<span class="nt">&lt;Rows&gt;</span>
  <span class="nt">&lt;Row&gt;</span>
    <span class="nt">&lt;ACCOUNT_REF&gt;</span>ABS001<span class="nt">&lt;/ACCOUNT_REF&gt;</span>
    <span class="nt">&lt;NAME&gt;</span>ABS Garages Ltd<span class="nt">&lt;/NAME&gt;</span>
    <span class="nt">&lt;BALANCE&gt;</span>2533.31<span class="nt">&lt;/BALANCE&gt;</span>
  <span class="nt">&lt;/Row&gt;</span>
<span class="nt">&lt;/Rows&gt;</span>
</code></pre>
</div>

                    <hr>
                    <div class="row">
                        <div class="col-sm-6"><a onclick="history.go(-1)" href="#"><span class="fa fa-arrow-left"></span>Back</a></div>
                        <div class="col-sm-6 text-right"><a href="http://github.com/Zynk-workflow/docs/tree/master/_documentation/Sage-50-UK-Connector/Exporting-Custom-Data-from-Sage-50-UK.md"><span class="fa fa-github"></span>Edit on Github</a></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- /#page-content-wrapper -->
</div>
<!-- /#wrapper -->


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<!-- Menu Toggle Script -->
<script>
    $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/js/bootstrap.min.js"></script>



<script>
    var screenWidth = $(window).width();

    // Add .active class to active link + scroll into view
    var pathinfo = location.pathname + location.hash;
    if (screenWidth > 768 && pathinfo != "/")
    {
        var scrollItem = $("#sidebar-wrapper").find("a[href='" + pathinfo + "']")
                .addClass('active')
                .parents().filter("div>ul>li")[0];
        if (scrollItem) {
            scrollItem.scrollIntoView({
                behavior: "smooth",
                block: "start"
            });
        }
    }

    // Add external link icon next to external menu links
    $(".sidebar-nav a[href^=http]")
        .append('<i class="fa fa-external-link" style="margin-left:-15px"></i>');

    $("#menu-toggle").click(function(){
        $("#sidebar-wrapper").scrollTop(0);
        $(this).toggleClass("fa-angle-down");
        $("#wrapper").toggleClass("menu-collapsed");
    });

    if (screenWidth <= 768) {
        $("#menu-toggle").click();            
    }

    //Allow clicking on non-linked headers to jump to its #href
    $("h2,h3,h4").click(function(){
        if (this.id && this.innerHTML.indexOf("<a") == -1) {
            location.href = "#" + this.id;
        }
    });

    
    
    //should no longer be needed now that we're referencing server-side /slug permalinks
(function () {
    "use strict";
    String.prototype.replaceAll = function(search, replacement) {
        var target = this;
        return target.split(search).join(replacement);
    };

    function fixDoubleBracketLinks(cssSelector) {
        var sidebarText = $(cssSelector)[0].innerHTML;
        var matches = sidebarText.match(/\[\[(.+?)\]\]/g);
        var result = sidebarText;
        if(matches != null) {
            for(var i = 0; i < matches.length; i++) {
                var text = matches[i].replaceAll('[[','').replaceAll(']]','');
                result = result.replace(matches[i],
                    '<a href="' +
                    encodeURIComponent(text.replaceAll(' ','-').toLocaleLowerCase()) +
                    '">' + text + '</a>')
            }
            $(cssSelector).html(result);
        }
    }

    fixDoubleBracketLinks('#page-content-wrapper');
    fixDoubleBracketLinks('#sidebar-wrapper');
})();
    
</script>
    
    
    
</body>
</html>
