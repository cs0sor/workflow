<!DOCTYPE html>
<html lang="en">
<head>
    <title>Using XML Library</title>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="shortcut icon" type="image/png" href="/images/favicon.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,600,900" rel="stylesheet">
    <link rel="stylesheet" href="css/github.css">
    <link rel="stylesheet" href="css/nav.css">
    <link rel="stylesheet" href="css/sidebar.css">
    <link rel="stylesheet" href="css/style.css">
 </head>
<body>

<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="xcontainer">
        <div class="navbar-header">
            <a class="navbar-brand" title="Go to Zynk.com" href="http://zynk.com"><img class="img-responsive" id="logo-main" src="assets/logo.svg" alt="Click here to visit Zynk.com" /></a>
        </div>
        <div id="myNavbar">
                <ul class="nav navbar-nav navbar-right">
                    <li class="topnav-2"><a href="mailto:support@zynk.com">support@zynk.com</a></li>
                </ul>
        </div>
    </div>
</nav>

<div id="wrapper">

    <!-- Sidebar -->
    <div id="sidebar-wrapper" class="sidebar-nav">
        
        <h1>Zynk Workflow Documentation</h1>
<ul>
  <li><a href="index">Home</a></li>
  <li>[[Introduction]]
    <ul>
      <li>[[Welcome]]</li>
      <li>[[Getting Started]]</li>
      <li>[[Key Concepts]]</li>
      <li>[[Using Zynk]]</li>
      <li>[[Settings]]</li>
      <li>[[Extensions]]</li>
      <li>[[Integrations]]</li>
    </ul>
  </li>
  <li>[[Accounting]]
    <ul>
      <li>[[Sage 50 UK]]</li>
      <li>[[Sage 200]]</li>
      <li>[[Sage 200 Online]]</li>
      <li>[[Xero]]</li>
      <li>[[Kashflow]]</li>
      <li>[[Quickbooks Online]]</li>
      <li>[[Sage 50 US]]</li>
      <li>[[Brightpearl]]</li>
      <li>[[Sage One]]</li>
      <li>[[Sage 50 Payroll]]</li>
      <li>[[Sage 50 UK Reporting]]</li>
    </ul>
  </li>
  <li>[[CRM]]
    <ul>
      <li>[[ACT]]</li>
      <li>[[AutoTask]]</li>
      <li>[[BXP]]</li>
      <li>[[Campaign Monitor]]</li>
      <li>[[ConnectWise]]</li>
      <li>[[Salesforce]]</li>
      <li>[[Sugar CRM]]</li>
      <li>[[Zoho CRM]]</li>
    </ul>
  </li>
  <li>[[Databases]]
    <ul>
      <li>[[SQL Server]]</li>
      <li>[[SQLite]]</li>
      <li>[[ODBC]]</li>
      <li>[[OLEDB]]</li>
    </ul>
  </li>
  <li>[[Ecommerce]]
    <ul>
      <li>[[Amazon Marketplace]]</li>
      <li>[[Amazon Vendor Central]]</li>
      <li>[[BigCommerce]]</li>
      <li>[[Channel Advisor]]</li>
      <li>[[CoreCommerce]]</li>
      <li>[[Easy Webstore]]</li>
      <li>[[Ebay]]</li>
      <li>[[EKM Powershop]]</li>
      <li>[[Magento V1]]</li>
      <li>[[Magento V2]]</li>
      <li>[[PayPal]]</li>
      <li>[[Shopify]]</li>
      <li>[[WooCommerce]]</li>
    </ul>
  </li>
  <li>[[Files]]
    <ul>
      <li>[[CSV]]</li>
      <li>[[HTML]]</li>
      <li>[[Excel]]</li>
      <li>[[File]]</li>
      <li>[[File Helpers]]</li>
      <li>[[JSON]]</li>
      <li>[[PDF]]</li>
      <li>[[XML and XSLT]]</li>
    </ul>
  </li>
  <li>[[Cloud]]
    <ul>
      <li>[[Amazon S3]]</li>
    </ul>
  </li>
  <li>[[Social]]
    <ul>
      <li>[[LinkedIn]]</li>
      <li>[[Twitter]]</li>
      <li>[[Facebook]]</li>
    </ul>
  </li>
  <li>[[Web]]
    <ul>
      <li>[[Email]]</li>
      <li>[[FTP]]</li>
      <li>[[SFTP]]</li>
      <li>[[HTTP]]</li>
    </ul>
  </li>
  <li>[[Other]]
    <ul>
      <li>[[Developer]]</li>
      <li>[[SMS]]</li>
      <li>[[User Interface]]</li>
      <li>[[WordPress]]</li>
      <li>[[Zynk Core]]</li>
    </ul>
  </li>
  <li>[[Contact Us]]</li>
</ul>

    </div>
    <!-- /#sidebar-wrapper -->

    <!-- Page Content -->
    <div id="page-content-wrapper">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-12 markdown-body">
                    <a onclick="history.go(-1)" href="#"><span class="fa fa-arrow-left"></span>Back</a>
                    <h1>Using XML Library</h1>
                    <p>This article will give an overview of how the XML and XSLT tasks can be used within a workflow to process and transformdata.  XML is used as the input and output of virtually all Zynk tasks, with various different object models being used.XSLT (and the Atuo Mapper task) can be used to convert data to the required format.</p>

<p>## Input XML 
 All of the examples arebased around the following StockTransaction XML, which should be saved out to your working directory as input.xml</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0"?&gt;</span>
<span class="nt">&lt;Company</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;StockTransactions&gt;</span>
        <span class="nt">&lt;StockTransaction&gt;</span>
            <span class="nt">&lt;UniqueId&gt;</span>1<span class="nt">&lt;/UniqueId&gt;</span>
            <span class="nt">&lt;StockTransactionType&gt;</span>AdjustmentIn<span class="nt">&lt;/StockTransactionType&gt;</span>
            <span class="nt">&lt;StockCode&gt;</span>BOARD001<span class="nt">&lt;/StockCode&gt;</span>
            <span class="nt">&lt;StockTransactionDate&gt;</span>2006-12-31T00:00:00<span class="nt">&lt;/StockTransactionDate&gt;</span>
            <span class="nt">&lt;Reference&gt;</span>STK TAKE<span class="nt">&lt;/Reference&gt;</span>
            <span class="nt">&lt;Details&gt;</span>Whiteboard - Drywipe (900 x 1200)<span class="nt">&lt;/Details&gt;</span>
            <span class="nt">&lt;Qty&gt;</span>2<span class="nt">&lt;/Qty&gt;</span>
            <span class="nt">&lt;CostPrice&gt;</span>15<span class="nt">&lt;/CostPrice&gt;</span>
            <span class="nt">&lt;SalesPrice&gt;</span>0<span class="nt">&lt;/SalesPrice&gt;</span>
            <span class="nt">&lt;StockTransactionNumber&gt;</span>1<span class="nt">&lt;/StockTransactionNumber&gt;</span>
        <span class="nt">&lt;/StockTransaction&gt;</span>
        <span class="nt">&lt;StockTransaction&gt;</span>
            <span class="nt">&lt;UniqueId&gt;</span>2<span class="nt">&lt;/UniqueId&gt;</span>
            <span class="nt">&lt;StockTransactionType&gt;</span>AdjustmentIn<span class="nt">&lt;/StockTransactionType&gt;</span>
            <span class="nt">&lt;StockCode&gt;</span>BOARD002<span class="nt">&lt;/StockCode&gt;</span>
            <span class="nt">&lt;StockTransactionDate&gt;</span>2006-12-31T00:00:00<span class="nt">&lt;/StockTransactionDate&gt;</span>
            <span class="nt">&lt;Reference&gt;</span>STK TAKE<span class="nt">&lt;/Reference&gt;</span>
            <span class="nt">&lt;Details&gt;</span>Whiteboard - Drywipe (1000 x 1500)<span class="nt">&lt;/Details&gt;</span>
            <span class="nt">&lt;Qty&gt;</span>2<span class="nt">&lt;/Qty&gt;</span>
            <span class="nt">&lt;CostPrice&gt;</span>17<span class="nt">&lt;/CostPrice&gt;</span>
            <span class="nt">&lt;SalesPrice&gt;</span>0<span class="nt">&lt;/SalesPrice&gt;</span>
            <span class="nt">&lt;StockTransactionNumber&gt;</span>2<span class="nt">&lt;/StockTransactionNumber&gt;</span>
        <span class="nt">&lt;/StockTransaction&gt;</span>
    <span class="nt">&lt;/StockTransactions&gt;</span>
<span class="nt">&lt;/Company&gt;</span>
</code></pre>
</div>

<h2 id="xml-split-example">XML Split Example</h2>
<p>XML Split can be used to batch large data sets into smaller chunks for processing, for example if you are uploading a large            number of products to a website you might want to split the file and send as multiple requests.</p>

<p>As an example we will split the above input XML file using the following settings:</p>

<h3 id="input-file">Input File</h3>
<p>Path to input.xml</p>

<h3 id="output-folder">Output Folder</h3>
<p>XML</p>

<h3 id="record-limit">Record Limit</h3>
<p>1</p>

<h3 id="xpath-query">XPath Query</h3>
<p>/Company/StockTransactions/StockTransaction</p>

<p>The result of the task will be two files created in the XML folder in the working directory.  In the sample workflow            there is a File Repeater task that will write out the names of the generated files using a Log Info Message task.</p>

<h2 id="xml-merge-example">XML Merge Example</h2>
<p>XML Merge can be used to create a single XML file from a number of smaller documents, for example if your third party systems            exports orders to individual files you can create a single import file for easier processing.</p>

<p>As an example we will merge back the two tasks from above using the following settings:</p>

<h3 id="input-files">Input Files</h3>
<p>(Output from previous task)</p>

<h3 id="output-file">Output File</h3>
<p>input2.xml</p>

<p>In the sample workflow there is a List Files task above the XML Merge task, this will provide the file listing from the XML            folder to the Input Files setting.  The result of the task will be a single file created called input2.xml            in the working directory.</p>

<h2 id="xml-repeater-example">XML Repeater Example</h2>
<p>XML Repeater can be used if you need to run part of your workflow based on the contents of an XML document, for example if            you need to update a database based on the values in the sample file you could build up and execute a SQL statement            based on the contents of the file.</p>

<p>As an example we will write out the StockCode values from the above output file with the following settings:</p>

<h3 id="input-file-1">Input File</h3>
<p>input2.xml</p>

<h3 id="xpath-query-1">XPath Query</h3>
<p>/Company/StockTransactions/StockTransaction</p>

<p>In the sample workflow we have a Log Info Message task that will write out the StockCode for each of the StockTransactions.</p>

<h2 id="xml-to-csv-example">XML to CSV Example</h2>
<p>XML to CSV can be used to create simple or complex mappings from XML to CSV, including support for flatting hierarchical            data e.g. orders with order items in our XML format to a flat CSV format, for example to create a report to open            in Excel.</p>

<p>As an example we will convert the output file from above into a simple CSV format with the following settings:</p>

<h3 id="input-file-2">Input File</h3>
<p>input2.xml</p>

<h3 id="mapping-fields">Mapping Fields</h3>
<p>StockCode -&gt; Code (string)  
StockTransactionType -&gt; type (string)  
Qty -&gt; quantity (decimal)  
CostPrice -&gt; Cost (decimal with format c)</p>

<h3 id="output-file-1">Output File</h3>
<p>output.csv</p>

<h3 id="xpath">XPath</h3>
<p>/Company/StockTransactions/StockTransaction</p>

<p>In the sample workflow we have a Log Info Message task that will write out the contents of the CSV file generated by the            workflow.</p>

<h2 id="xslt-transformation-example">XSLT Transformation Example</h2>
<p>XSLT Transformation is used in most integrations to convert between different XML formats, and the Auto Mapper tasks provides            a collection of pre-canned mappings that can be used to quickly build workflows.</p>

<p>Save the below to transform.xslt</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;xsl:stylesheet</span> 
    <span class="na">version=</span><span class="s">"1.0"</span>
    <span class="na">xmlns:xsl=</span><span class="s">"http://www.w3.org/1999/XSL/Transform"</span><span class="nt">&gt;</span>

    <span class="nt">&lt;xsl:output</span> <span class="na">method=</span><span class="s">"xml"</span> <span class="na">indent=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>

    <span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">"/"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;Rows&gt;</span>
            <span class="nt">&lt;xsl:for-each</span> <span class="na">select=</span><span class="s">"Company/StockTransactions/StockTransaction"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">"ProcessRow"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;/xsl:for-each&gt;</span>
        <span class="nt">&lt;/Rows&gt;</span>
    <span class="nt">&lt;/xsl:template&gt;</span>

    <span class="nt">&lt;xsl:template</span> <span class="na">name=</span><span class="s">"ProcessRow"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;Row&gt;</span>
            <span class="nt">&lt;Code&gt;&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">"StockCode"</span> <span class="nt">/&gt;&lt;/Code&gt;</span>
            <span class="nt">&lt;Type&gt;&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">"StockTransactionType"</span> <span class="nt">/&gt;&lt;/Type&gt;</span>
            <span class="nt">&lt;Quantity&gt;&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">"Qty"</span> <span class="nt">/&gt;&lt;/Quantity&gt;</span>
            <span class="nt">&lt;Cost&gt;&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">"CostPrice"</span> <span class="nt">/&gt;&lt;/Cost&gt;</span>
        <span class="nt">&lt;/Row&gt;</span>
    <span class="nt">&lt;/xsl:template&gt;</span>
    
<span class="nt">&lt;/xsl:stylesheet&gt;</span>
</code></pre>
</div>

<p>As an example we will convert the output file from the above into a simple XML format with the following settings:</p>

<h3 id="input-file-3">Input File</h3>
<p>input2.xml</p>

<h3 id="output-file-2">Output File</h3>
<p>output.xml</p>

<h3 id="xslt-file">XSLT File</h3>
<p>transform.xslt</p>

<p>In the sample workflow we have a Log Info message task that will write out the contents of the XML file generated by the workflow.</p>

                    <hr>
                    <div class="row">
                        <div class="col-sm-6"><a onclick="history.go(-1)" href="#"><span class="fa fa-arrow-left"></span>Back</a></div>
                        <div class="col-sm-6 text-right"><a href="http://github.com/Zynk-workflow/docs/tree/master/_documentation/Using-Zynk-Section/Using-XML-Library.md"><span class="fa fa-github"></span>Edit on Github</a></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- /#page-content-wrapper -->
</div>
<!-- /#wrapper -->


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<!-- Menu Toggle Script -->
<script>
    $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/js/bootstrap.min.js"></script>



<script>
    var screenWidth = $(window).width();

    // Add .active class to active link + scroll into view
    var pathinfo = location.pathname + location.hash;
    if (screenWidth > 768 && pathinfo != "/")
    {
        var scrollItem = $("#sidebar-wrapper").find("a[href='" + pathinfo + "']")
                .addClass('active')
                .parents().filter("div>ul>li")[0];
        if (scrollItem) {
            scrollItem.scrollIntoView({
                behavior: "smooth",
                block: "start"
            });
        }
    }

    // Add external link icon next to external menu links
    $(".sidebar-nav a[href^=http]")
        .append('<i class="fa fa-external-link" style="margin-left:-15px"></i>');

    $("#menu-toggle").click(function(){
        $("#sidebar-wrapper").scrollTop(0);
        $(this).toggleClass("fa-angle-down");
        $("#wrapper").toggleClass("menu-collapsed");
    });

    if (screenWidth <= 768) {
        $("#menu-toggle").click();            
    }

    //Allow clicking on non-linked headers to jump to its #href
    $("h2,h3,h4").click(function(){
        if (this.id && this.innerHTML.indexOf("<a") == -1) {
            location.href = "#" + this.id;
        }
    });

    
    
    //should no longer be needed now that we're referencing server-side /slug permalinks
(function () {
    "use strict";
    String.prototype.replaceAll = function(search, replacement) {
        var target = this;
        return target.split(search).join(replacement);
    };

    function fixDoubleBracketLinks(cssSelector) {
        var sidebarText = $(cssSelector)[0].innerHTML;
        var matches = sidebarText.match(/\[\[(.+?)\]\]/g);
        var result = sidebarText;
        if(matches != null) {
            for(var i = 0; i < matches.length; i++) {
                var text = matches[i].replaceAll('[[','').replaceAll(']]','');
                result = result.replace(matches[i],
                    '<a href="' +
                    encodeURIComponent(text.replaceAll(' ','-').toLocaleLowerCase()) +
                    '">' + text + '</a>')
            }
            $(cssSelector).html(result);
        }
    }

    fixDoubleBracketLinks('#page-content-wrapper');
    fixDoubleBracketLinks('#sidebar-wrapper');
})();
    
</script>
    
    
    
</body>
</html>
