<!DOCTYPE html>
<html lang="en">
<head>
    <title>XSLT Transform</title>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="shortcut icon" type="image/png" href="/images/favicon.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,600,900" rel="stylesheet">
    <link rel="stylesheet" href="css/github.css">
    <link rel="stylesheet" href="css/nav.css">
    <link rel="stylesheet" href="css/sidebar.css">
    <link rel="stylesheet" href="css/style.css">
 </head>
<body>

<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="xcontainer">
        <div class="navbar-header">
            <a class="navbar-brand" title="Go to Zynk.com" href="http://zynk.com"><img class="img-responsive" id="logo-main" src="assets/logo.svg" alt="Click here to visit Zynk.com" /></a>
        </div>
        <div id="myNavbar">
                <ul class="nav navbar-nav navbar-right">
                    <li class="topnav-2"><a href="mailto:support@zynk.com">support@zynk.com</a></li>
                </ul>
        </div>
    </div>
</nav>

<div id="wrapper">

    <!-- Sidebar -->
    <div id="sidebar-wrapper" class="sidebar-nav">
        
        <h1>Zynk Workflow Documentation</h1>
<ul>
  <li><a href="index">Home</a></li>
  <li>[[Introduction]]
    <ul>
      <li>[[Welcome]]</li>
      <li>[[Getting Started]]</li>
      <li>[[Key Concepts]]</li>
      <li>[[Using Zynk]]</li>
      <li>[[Settings]]</li>
      <li>[[Extensions]]</li>
      <li>[[Integrations]]</li>
    </ul>
  </li>
  <li>[[Accounting]]
    <ul>
      <li>[[Sage 50 UK]]</li>
      <li>[[Sage 200]]</li>
      <li>[[Sage 200 Online]]</li>
      <li>[[Xero]]</li>
      <li>[[Kashflow]]</li>
      <li>[[Quickbooks Online]]</li>
      <li>[[Sage 50 US]]</li>
      <li>[[Brightpearl]]</li>
      <li>[[Sage One]]</li>
      <li>[[Sage 50 Payroll]]</li>
      <li>[[Sage 50 UK Reporting]]</li>
    </ul>
  </li>
  <li>[[CRM]]
    <ul>
      <li>[[ACT]]</li>
      <li>[[AutoTask]]</li>
      <li>[[BXP]]</li>
      <li>[[Campaign Monitor]]</li>
      <li>[[ConnectWise]]</li>
      <li>[[Salesforce]]</li>
      <li>[[Sugar CRM]]</li>
      <li>[[Zoho CRM]]</li>
    </ul>
  </li>
  <li>[[Databases]]
    <ul>
      <li>[[SQL Server]]</li>
      <li>[[SQLite]]</li>
      <li>[[ODBC]]</li>
      <li>[[OLEDB]]</li>
    </ul>
  </li>
  <li>[[Ecommerce]]
    <ul>
      <li>[[Amazon Marketplace]]</li>
      <li>[[Amazon Vendor Central]]</li>
      <li>[[BigCommerce]]</li>
      <li>[[Channel Advisor]]</li>
      <li>[[CoreCommerce]]</li>
      <li>[[Easy Webstore]]</li>
      <li>[[Ebay]]</li>
      <li>[[EKM Powershop]]</li>
      <li>[[Magento V1]]</li>
      <li>[[Magento V2]]</li>
      <li>[[PayPal]]</li>
      <li>[[Shopify]]</li>
      <li>[[WooCommerce]]</li>
    </ul>
  </li>
  <li>[[Files]]
    <ul>
      <li>[[CSV]]</li>
      <li>[[HTML]]</li>
      <li>[[Excel]]</li>
      <li>[[File]]</li>
      <li>[[File Helpers]]</li>
      <li>[[JSON]]</li>
      <li>[[PDF]]</li>
      <li>[[XML and XSLT]]</li>
    </ul>
  </li>
  <li>[[Cloud]]
    <ul>
      <li>[[Amazon S3]]</li>
    </ul>
  </li>
  <li>[[Social]]
    <ul>
      <li>[[LinkedIn]]</li>
      <li>[[Twitter]]</li>
      <li>[[Facebook]]</li>
    </ul>
  </li>
  <li>[[Web]]
    <ul>
      <li>[[Email]]</li>
      <li>[[FTP]]</li>
      <li>[[SFTP]]</li>
      <li>[[HTTP]]</li>
    </ul>
  </li>
  <li>[[Other]]
    <ul>
      <li>[[Developer]]</li>
      <li>[[SMS]]</li>
      <li>[[User Interface]]</li>
      <li>[[WordPress]]</li>
      <li>[[Zynk Core]]</li>
    </ul>
  </li>
  <li>[[Contact Us]]</li>
</ul>

    </div>
    <!-- /#sidebar-wrapper -->

    <!-- Page Content -->
    <div id="page-content-wrapper">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-12 markdown-body">
                    <a onclick="history.go(-1)" href="#"><span class="fa fa-arrow-left"></span>Back</a>
                    <h1>XSLT Transform</h1>
                    <p>The XSLT Transform task accepts an XML input file and transforms it to another format using an XSL transform file. XSL transforms can be used used to convert an XML file to another XML format, HTML, CSV, plain text and many more formats. You can pass through parameters to the XSLT at runtime if your XSLT file supports parameterised inputs. Please note that the task only supports XSLT 1.0, it does not support XSLT 2.0.</p>

<p>A basic tutorial for writing XSL transforms can be found <a href="621-create-an-xslt-file">here</a>, and more detailed information can be found at <a href="http://www.w3schools.com/xsl/default.asp">W3 Schools</a>. You can find sample XSLT files in our <a href="https://github.com/internetware/zynk-samples/tree/master/XSLT%20Samples">Github repository</a>.</p>

<h2 id="settings">Settings</h2>
<h3 id="input-file">Input File</h3>
<p><em>Required</em><br />
The name of the XML file for processing.</p>

<h3 id="log-file">Log File</h3>
<p><em>Optional</em><br />
The file to write any messages generated by the XSLT to. You can generate messages by using the	<a href="http://www.w3schools.com/Xsl/el_message.asp">xsl:message</a> element in your XSLT. If you don’t provide a log file, messages will still be written as debug messages to the logs in Zynk (if debug logging is enabled).</p>

<h3 id="output-file">Output File</h3>
<p><em>Required</em><br />
The name of the resulting processed file.</p>

<h3 id="parameters">Parameters</h3>
<p><em>Optional</em><br />
A collection of parameters to be passed into the XSLT for processing. This is typically used for user defined data such as Company Name and Address when using a common XSLT file such as an Invoice.xslt.</p>

<h3 id="xslt-file">XSLT File</h3>
<p><em>Required</em><br />
The name of the XSLT file to use for processing.</p>

<h3 id="zynk-settings">Zynk Settings</h3>
<p>See <a href="common-task-settings">Common Task Settings</a></p>

<h2 id="examples">Examples</h2>
<p>A sample input file is shown below, which is to be converted to another XML format.</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0"?&gt;</span>
<span class="nt">&lt;Company</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;StockTransactions&gt;</span>
        <span class="nt">&lt;StockTransaction&gt;</span>
            <span class="nt">&lt;UniqueId&gt;</span>1<span class="nt">&lt;/UniqueId&gt;</span>
            <span class="nt">&lt;StockTransactionType&gt;</span>AdjustmentIn<span class="nt">&lt;/StockTransactionType&gt;</span>
            <span class="nt">&lt;StockCode&gt;</span>BOARD001<span class="nt">&lt;/StockCode&gt;</span>
            <span class="nt">&lt;StockTransactionDate&gt;</span>2006-12-31T00:00:00<span class="nt">&lt;/StockTransactionDate&gt;</span>
            <span class="nt">&lt;Reference&gt;</span>STK TAKE<span class="nt">&lt;/Reference&gt;</span>
            <span class="nt">&lt;Details&gt;</span>Whiteboard - Drywipe (900 x 1200)<span class="nt">&lt;/Details&gt;</span>
            <span class="nt">&lt;Qty&gt;</span>2<span class="nt">&lt;/Qty&gt;</span>
            <span class="nt">&lt;CostPrice&gt;</span>15<span class="nt">&lt;/CostPrice&gt;</span>
            <span class="nt">&lt;SalesPrice&gt;</span>0<span class="nt">&lt;/SalesPrice&gt;</span>
            <span class="nt">&lt;StockTransactionNumber&gt;</span>1<span class="nt">&lt;/StockTransactionNumber&gt;</span>
        <span class="nt">&lt;/StockTransaction&gt;</span>
    <span class="nt">&lt;/StockTransactions&gt;</span>
<span class="nt">&lt;/Company&gt;</span>
</code></pre>
</div>

<p>A sample XSLT file is shown below, which will be used to transform the input file.</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;xsl:stylesheet</span> <span class="na">version=</span><span class="s">"1.0"</span> <span class="na">xmlns:xsl=</span><span class="s">"http://www.w3.org/1999/XSL/Transform"</span><span class="nt">&gt;</span>

    <span class="nt">&lt;xsl:output</span> <span class="na">method=</span><span class="s">"xml"</span> <span class="na">indent=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>

    <span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">"/"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;Rows&gt;</span>
            <span class="nt">&lt;xsl:for-each</span> <span class="na">select=</span><span class="s">"Company/StockTransactions/StockTransaction"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">"ProcessRow"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;/xsl:for-each&gt;</span>
        <span class="nt">&lt;/Rows&gt;</span>
    <span class="nt">&lt;/xsl:template&gt;</span>

    <span class="nt">&lt;xsl:template</span> <span class="na">name=</span><span class="s">"ProcessRow"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;Row&gt;</span>
            <span class="nt">&lt;Code&gt;&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">"StockCode"</span> <span class="nt">/&gt;&lt;/Code&gt;</span>
            <span class="nt">&lt;Type&gt;&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">"StockTransactionType"</span> <span class="nt">/&gt;&lt;/Type&gt;</span>
            <span class="nt">&lt;Quantity&gt;&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">"Qty"</span> <span class="nt">/&gt;&lt;/Quantity&gt;</span>
            <span class="nt">&lt;Cost&gt;&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">"CostPrice"</span> <span class="nt">/&gt;&lt;/Cost&gt;</span>
        <span class="nt">&lt;/Row&gt;</span>
    <span class="nt">&lt;/xsl:template&gt;</span>
    
<span class="nt">&lt;/xsl:stylesheet&gt;</span>
</code></pre>
</div>

<p>The output file is shown below:</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;Rows&gt;</span>
  <span class="nt">&lt;Row&gt;</span>
    <span class="nt">&lt;Code&gt;</span>BOARD001<span class="nt">&lt;/Code&gt;</span>
    <span class="nt">&lt;Type&gt;</span>AdjustmentIn<span class="nt">&lt;/Type&gt;</span>
    <span class="nt">&lt;Quantity&gt;</span>2<span class="nt">&lt;/Quantity&gt;</span>
    <span class="nt">&lt;Cost&gt;</span>15<span class="nt">&lt;/Cost&gt;</span>
  <span class="nt">&lt;/Row&gt;</span>
<span class="nt">&lt;/Rows&gt;</span>
</code></pre>
</div>

<h2 id="extensions">Extensions</h2>
<p>The following extension objects and methods are provided for use within your XSLT. See below for an example of how to use them.</p>

<h3 id="date-functions">Date Functions</h3>
<p>Namespace: urn:DateFunctions<br />
Available Since: Zynk Workflow 2.1.4</p>

<h4 id="date-format">Date Format</h4>
<p>Converts a given string to an XSD date. <br />
<code class="highlighter-rouge">DateFormat(string dateString)</code></p>

<ul>
  <li>dateString - The date to convert.</li>
</ul>

<h4 id="date-format-1">Date Format</h4>
<p>Converts a given string to a date format of your choice. <br />
<code class="highlighter-rouge">DateFormat(string dateString, string format)</code></p>

<ul>
  <li>dateString - The date to convert.</li>
  <li>format - The format to output the date in. See <a href="https://msdn.microsoft.com/en-us/library/8kb3ddd4(v=vs.110).aspx">Custom Date and Time Format Strings</a> for more details.</li>
</ul>

<h4 id="add-days">Add Days</h4>
<p>Converts a given string to an XSD date, and adds a specified number of days. <br />
<code class="highlighter-rouge">AddDays(string dateString, double days)</code></p>

<ul>
  <li>dateString - The date to convert.</li>
  <li>days - The number of days to add/subtract to the date.</li>
</ul>

<h4 id="add-days-1">Add Days</h4>
<p>Converts a given string to a date format of your choice, and adds a specified number of days. <br />
<code class="highlighter-rouge">AddDays(string dateString, double days, string format)</code></p>

<ul>
  <li>dateString - The date to convert.</li>
  <li>days - The number of days to add/subtract to the date.</li>
  <li>format - The format to output the date in. See <a href="https://msdn.microsoft.com/en-us/library/8kb3ddd4(v=vs.110).aspx">Custom Date and Time Format Strings</a> for more details.</li>
</ul>

<h4 id="add-months">Add Months</h4>
<p>Converts a given string to an XSD date, and adds a specified number of months. <br />
<code class="highlighter-rouge">AddMonths(string dateString, int months)</code></p>

<ul>
  <li>dateString - The date to convert.</li>
  <li>months - The number of months to add/subtract to the date.</li>
</ul>

<h4 id="add-months-1">Add Months</h4>
<p>Converts a given string to a date format of your choice, and adds a specified number of months. <br />
<code class="highlighter-rouge">AddMonths(string dateString, int months, string format)</code></p>

<ul>
  <li>dateString - The date to convert.</li>
  <li>months - The number of months to add/subtract to the date.</li>
  <li>format - The format to output the date in. See here for <a href="https://msdn.microsoft.com/en-us/library/8kb3ddd4(v=vs.110).aspx">Custom Date and Time Format Strings</a> details.</li>
</ul>

<h4 id="add-years">Add Years</h4>
<p>Converts a given string to an XSD date, and adds a specified number of years. <br />
<code class="highlighter-rouge">AddYears(string dateString, int years)</code></p>

<ul>
  <li>dateString - The date to convert.</li>
  <li>years - The number of years to add/subtract to the date.</li>
</ul>

<h4 id="add-years-1">Add Years</h4>
<p>Converts a given string to a date format of your choice, and adds a specified number of years. <br />
<code class="highlighter-rouge">AddYears(string dateString, int years, string format)</code></p>

<ul>
  <li>dateString - The date to convert.</li>
  <li>years - The number of years to add/subtract to the date.</li>
  <li>format - The format to output the date in. See <a href="https://msdn.microsoft.com/en-us/library/8kb3ddd4(v=vs.110).aspx">Custom Date and Time Format Strings</a> for more details.</li>
</ul>

<h3 id="file-functions">File Functions</h3>
<p>Namespace: urn:FileFunctions<br />
Available Since: Zynk Workflow 2.1.4</p>

<h4 id="file-exists">File Exists</h4>
<p>Checks if a given file exists. <br />
<code class="highlighter-rouge">FileExists(string file)</code></p>

<ul>
  <li>file - The file to check.</li>
</ul>

<h4 id="valid-xml">Valid XML</h4>
<p>Checks if a given file exists, and contains valid XML data. <br />
<code class="highlighter-rouge">ValidXml(string file)</code></p>

<ul>
  <li>file - The file to check.</li>
</ul>

<h3 id="node-functions">Node Functions</h3>
<p>Namespace: urn:NodeFunctions<br />
Available Since: Zynk Workflow 2.1.4</p>

<h4 id="select">Select</h4>
<p>Selects a node based on an XPath expression. Supports dynamically generated XPath expressions. <br />
<code class="highlighter-rouge">Select(Node node, string xpath)</code></p>

<ul>
  <li>node - The node to run the XPath expression against. This would typically be the current node ‘.’</li>
  <li>xpath - The XPath expression to return the desired node.</li>
</ul>

<h3 id="mapping-functions">Mapping Functions</h3>
<p>Namespace: urn:MappingFunctions<br />
Available Since: Zynk Workflow 2.1.8</p>

<h4 id="map-to">Map To</h4>
<p>Returns the ‘to’ value from the specified <a href="mapping">Mapping</a>, based on the specified ‘from’ value.<br />
<code class="highlighter-rouge">MapTo(string mappingName, string from)</code></p>

<ul>
  <li>mappingName - The name of the mapping to use.</li>
  <li>from - The value to be mapped from</li>
</ul>

<h4 id="map-from">Map From</h4>
<p>Returns the ‘from’ value from the specified <a href="mapping">Mapping</a>, based on the specified ‘to’ value.<br />
<code class="highlighter-rouge">MapFrom(string mappingName, string to)</code></p>

<ul>
  <li>mappingName - The name of the mapping to use.</li>
  <li>to - The value to be mapped to.</li>
</ul>

<h3 id="example-usage">Example Usage</h3>
<p>The XSLT below uses the DateFormat method to convert the value of the MyDate node from the input file to another format.</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;xsl:stylesheet</span> <span class="na">version=</span><span class="s">"1.0"</span>
  <span class="na">xmlns:xsl=</span><span class="s">"http://www.w3.org/1999/XSL/Transform"</span>
  <span class="na">xmlns:df=</span><span class="s">"urn:DateFunctions"</span><span class="nt">&gt;</span> <span class="c">&lt;!-- Declare the namespace of the function(s) 
you want to use here --&gt;</span>

    <span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">"/"</span><span class="nt">&gt;</span>
        <span class="c">&lt;!-- Call the function within an XPath expression, prefixing the function name 
        with the namespace you've declared followed by a colon --&gt;</span>
        <span class="nt">&lt;Date&gt;&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">"df:DateFormat(MyDate, 'yyyy-MM-dd_HH:mm:ss')"</span> <span class="nt">/&gt;&lt;/Date&gt;</span>
    <span class="nt">&lt;/xsl:template&gt;</span>

<span class="nt">&lt;/xsl:stylesheet&gt;</span>
</code></pre>
</div>

                    <hr>
                    <div class="row">
                        <div class="col-sm-6"><a onclick="history.go(-1)" href="#"><span class="fa fa-arrow-left"></span>Back</a></div>
                        <div class="col-sm-6 text-right"><a href="http://github.com/Zynk-workflow/docs/tree/master/_documentation/XML-and-XSLT-Connector/XSLT-Transform.md"><span class="fa fa-github"></span>Edit on Github</a></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- /#page-content-wrapper -->
</div>
<!-- /#wrapper -->


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<!-- Menu Toggle Script -->
<script>
    $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/js/bootstrap.min.js"></script>



<script>
    var screenWidth = $(window).width();

    // Add .active class to active link + scroll into view
    var pathinfo = location.pathname + location.hash;
    if (screenWidth > 768 && pathinfo != "/")
    {
        var scrollItem = $("#sidebar-wrapper").find("a[href='" + pathinfo + "']")
                .addClass('active')
                .parents().filter("div>ul>li")[0];
        if (scrollItem) {
            scrollItem.scrollIntoView({
                behavior: "smooth",
                block: "start"
            });
        }
    }

    // Add external link icon next to external menu links
    $(".sidebar-nav a[href^=http]")
        .append('<i class="fa fa-external-link" style="margin-left:-15px"></i>');

    $("#menu-toggle").click(function(){
        $("#sidebar-wrapper").scrollTop(0);
        $(this).toggleClass("fa-angle-down");
        $("#wrapper").toggleClass("menu-collapsed");
    });

    if (screenWidth <= 768) {
        $("#menu-toggle").click();            
    }

    //Allow clicking on non-linked headers to jump to its #href
    $("h2,h3,h4").click(function(){
        if (this.id && this.innerHTML.indexOf("<a") == -1) {
            location.href = "#" + this.id;
        }
    });

    
    
    //should no longer be needed now that we're referencing server-side /slug permalinks
(function () {
    "use strict";
    String.prototype.replaceAll = function(search, replacement) {
        var target = this;
        return target.split(search).join(replacement);
    };

    function fixDoubleBracketLinks(cssSelector) {
        var sidebarText = $(cssSelector)[0].innerHTML;
        var matches = sidebarText.match(/\[\[(.+?)\]\]/g);
        var result = sidebarText;
        if(matches != null) {
            for(var i = 0; i < matches.length; i++) {
                var text = matches[i].replaceAll('[[','').replaceAll(']]','');
                result = result.replace(matches[i],
                    '<a href="' +
                    encodeURIComponent(text.replaceAll(' ','-').toLocaleLowerCase()) +
                    '">' + text + '</a>')
            }
            $(cssSelector).html(result);
        }
    }

    fixDoubleBracketLinks('#page-content-wrapper');
    fixDoubleBracketLinks('#sidebar-wrapper');
})();
    
</script>
    
    
    
</body>
</html>
