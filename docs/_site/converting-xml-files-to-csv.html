<!DOCTYPE html>
<html lang="en">
<head>
    <title>Converting XML files to CSV</title>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="shortcut icon" type="image/png" href="/images/favicon.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,600,900" rel="stylesheet">
    <link rel="stylesheet" href="css/github.css">
    <link rel="stylesheet" href="css/nav.css">
    <link rel="stylesheet" href="css/sidebar.css">
    <link rel="stylesheet" href="css/style.css">
 </head>
<body>

<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="xcontainer">
        <div class="navbar-header">
            <a class="navbar-brand" title="Go to Zynk.com" href="http://zynk.com"><img class="img-responsive" id="logo-main" src="assets/logo.svg" alt="Click here to visit Zynk.com" /></a>
        </div>
        <div id="myNavbar">
                <ul class="nav navbar-nav navbar-right">
                    <li class="topnav-2"><a href="mailto:support@zynk.com">support@zynk.com</a></li>
                </ul>
        </div>
    </div>
</nav>

<div id="wrapper">

    <!-- Sidebar -->
    <div id="sidebar-wrapper" class="sidebar-nav">
        
        <h1>Zynk Workflow Documentation</h1>
<ul>
  <li><a href="index">Home</a></li>
  <li>[[Introduction]]
    <ul>
      <li>[[Welcome]]</li>
      <li>[[Getting Started]]</li>
      <li>[[Key Concepts]]</li>
      <li>[[Using Zynk]]</li>
      <li>[[Settings]]</li>
      <li>[[Extensions]]</li>
      <li>[[Integrations]]</li>
    </ul>
  </li>
  <li>[[Accounting]]
    <ul>
      <li>[[Sage 50 UK]]</li>
      <li>[[Sage 200]]</li>
      <li>[[Sage 200 Online]]</li>
      <li>[[Xero]]</li>
      <li>[[Kashflow]]</li>
      <li>[[Quickbooks Online]]</li>
      <li>[[Sage 50 US]]</li>
      <li>[[Brightpearl]]</li>
      <li>[[Sage One]]</li>
      <li>[[Sage 50 Payroll]]</li>
      <li>[[Sage 50 UK Reporting]]</li>
    </ul>
  </li>
  <li>[[CRM]]
    <ul>
      <li>[[ACT]]</li>
      <li>[[AutoTask]]</li>
      <li>[[BXP]]</li>
      <li>[[Campaign Monitor]]</li>
      <li>[[ConnectWise]]</li>
      <li>[[Salesforce]]</li>
      <li>[[Sugar CRM]]</li>
      <li>[[Zoho CRM]]</li>
    </ul>
  </li>
  <li>[[Databases]]
    <ul>
      <li>[[SQL Server]]</li>
      <li>[[SQLite]]</li>
      <li>[[ODBC]]</li>
      <li>[[OLEDB]]</li>
    </ul>
  </li>
  <li>[[Ecommerce]]
    <ul>
      <li>[[Amazon Marketplace]]</li>
      <li>[[Amazon Vendor Central]]</li>
      <li>[[BigCommerce]]</li>
      <li>[[Channel Advisor]]</li>
      <li>[[CoreCommerce]]</li>
      <li>[[Easy Webstore]]</li>
      <li>[[Ebay]]</li>
      <li>[[EKM Powershop]]</li>
      <li>[[Magento V1]]</li>
      <li>[[Magento V2]]</li>
      <li>[[PayPal]]</li>
      <li>[[Shopify]]</li>
      <li>[[WooCommerce]]</li>
    </ul>
  </li>
  <li>[[Files]]
    <ul>
      <li>[[CSV]]</li>
      <li>[[HTML]]</li>
      <li>[[Excel]]</li>
      <li>[[File]]</li>
      <li>[[File Helpers]]</li>
      <li>[[JSON]]</li>
      <li>[[PDF]]</li>
      <li>[[XML and XSLT]]</li>
    </ul>
  </li>
  <li>[[Cloud]]
    <ul>
      <li>[[Amazon S3]]</li>
    </ul>
  </li>
  <li>[[Social]]
    <ul>
      <li>[[LinkedIn]]</li>
      <li>[[Twitter]]</li>
      <li>[[Facebook]]</li>
    </ul>
  </li>
  <li>[[Web]]
    <ul>
      <li>[[Email]]</li>
      <li>[[FTP]]</li>
      <li>[[SFTP]]</li>
      <li>[[HTTP]]</li>
    </ul>
  </li>
  <li>[[Other]]
    <ul>
      <li>[[Developer]]</li>
      <li>[[SMS]]</li>
      <li>[[User Interface]]</li>
      <li>[[WordPress]]</li>
      <li>[[Zynk Core]]</li>
    </ul>
  </li>
  <li>[[Contact Us]]</li>
</ul>

    </div>
    <!-- /#sidebar-wrapper -->

    <!-- Page Content -->
    <div id="page-content-wrapper">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-12 markdown-body">
                    <a onclick="history.go(-1)" href="#"><span class="fa fa-arrow-left"></span>Back</a>
                    <h1>Converting XML files to CSV</h1>
                    <p>This tutorial will help you to convert XML files to CSV format using the XML to CSV task in Zynk.</p>

<h2 id="the-xml-to-csv-task">The XML to CSV Task</h2>
<p>On this task you will see the following settings:</p>

<ul>
  <li><strong>Delimiter</strong> - The character to use to delimit the data in the CSV file. Usually this will be either a quotation mark or just left blank.</li>
  <li><strong>Input File</strong> - The XML file to convert to CSV.</li>
  <li><strong>Mapping Fields</strong> - This allows you to customise the way the XML is mapped into CSV format. See below for a full explanation.</li>
  <li><strong>Output File</strong> - The name of the XML file to create containing the XML representation of the Excel worksheet</li>
  <li><strong>Separator</strong> - The separator to use in the output CSV file. This will usually be a comma.</li>
  <li><strong>XPath</strong> - The XPath query to find the data to output to the CSV file.</li>
</ul>

<p>In the examples below, we will use the following XML as the input file.</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;Company&gt;</span>
  <span class="nt">&lt;SalesOrders&gt;</span>
    <span class="nt">&lt;SalesOrder&gt;</span>
      <span class="nt">&lt;Id&gt;</span>12345<span class="nt">&lt;/Id&gt;</span>
      <span class="nt">&lt;AccountReference&gt;</span>INTE001<span class="nt">&lt;/AccountReference&gt;</span>
      <span class="nt">&lt;SalesOrderDate&gt;</span>2011-01-01T11:11:11<span class="nt">&lt;/SalesOrderDate&gt;</span>
      <span class="nt">&lt;SalesOrderAddress&gt;</span>
        <span class="nt">&lt;Title&gt;</span>Mr<span class="nt">&lt;/Title&gt;</span>
        <span class="nt">&lt;Forename&gt;</span>Test<span class="nt">&lt;/Forename&gt;</span>
        <span class="nt">&lt;Surname&gt;</span>Person<span class="nt">&lt;/Surname&gt;</span>
        <span class="nt">&lt;Address1&gt;</span>i6 Building<span class="nt">&lt;/Address1&gt;</span>
        <span class="nt">&lt;Address2&gt;</span>6-8 Charlotte Square<span class="nt">&lt;/Address2&gt;</span>
        <span class="nt">&lt;Town&gt;</span>Newcastle Upon Tyne<span class="nt">&lt;/Town&gt;</span>
        <span class="nt">&lt;Postcode&gt;</span>NE1 4XF<span class="nt">&lt;/Postcode&gt;</span>
        <span class="nt">&lt;County&gt;</span>County<span class="nt">&lt;/County&gt;</span>
        <span class="nt">&lt;Country&gt;</span>GB<span class="nt">&lt;/Country&gt;</span>
      <span class="nt">&lt;/SalesOrderAddress&gt;</span>
      <span class="nt">&lt;SalesOrderItems&gt;</span>
        <span class="nt">&lt;Item&gt;</span>
          <span class="nt">&lt;Sku&gt;</span>TEST01<span class="nt">&lt;/Sku&gt;</span>
          <span class="nt">&lt;QtyOrdered&gt;</span>1<span class="nt">&lt;/QtyOrdered&gt;</span>
          <span class="nt">&lt;UnitPrice&gt;</span>200<span class="nt">&lt;/UnitPrice&gt;</span>
        <span class="nt">&lt;/Item&gt;</span>
        <span class="nt">&lt;Item&gt;</span>
          <span class="nt">&lt;Sku&gt;</span>TEST02<span class="nt">&lt;/Sku&gt;</span>
          <span class="nt">&lt;QtyOrdered&gt;</span>1<span class="nt">&lt;/QtyOrdered&gt;</span>
          <span class="nt">&lt;UnitPrice&gt;</span>200<span class="nt">&lt;/UnitPrice&gt;</span>
        <span class="nt">&lt;/Item&gt;</span>
      <span class="nt">&lt;/SalesOrderItems&gt;</span>
    <span class="nt">&lt;/SalesOrder&gt;</span>
  <span class="nt">&lt;/SalesOrders&gt;</span>
<span class="nt">&lt;/Company&gt;</span>
</code></pre>
</div>

<h2 id="the-default-mapping">The Default Mapping</h2>
<p>The default mapping will output the values of child nodes and attributes of the nodes returned by the XPath query. If we set the XPath query in the task settings to <code class="highlighter-rouge">Company/SalesOrders/SalesOrder</code>, the following output is produced:</p>

<pre><code class="language-csv">Id,AccountReference,SalesOrderDate
12345,INTE001,2011-01-01T11:11:11
</code></pre>

<h2 id="customising-the-mapping">Customising the Mapping</h2>
<p>If the default mapping does not produce the results you require, a custom mapping can be created to output the data in a specific format. This is done using the Mapping fields setting on the task. When editing the Mapping Fields, you will see a window like the one below.</p>

<p><a href="https://s3.amazonaws.com/helpscout.net/docs/assets/565effd4c697915b26a5c620/images/56b47a4d9033603f7da383d7/file-MNvYeDzudD.jpg"><img src="https://s3.amazonaws.com/helpscout.net/docs/assets/565effd4c697915b26a5c620/images/56b47a4d9033603f7da383d7/file-MNvYeDzudD.jpg" alt="" /></a></p>

<p>There are 4 columns, which are used as follows:</p>

<ul>
  <li><strong>From</strong>- The relative XPath query to get the required field. In the first row in the example above, if the XPath ‘Company/SalesOrders/SalesOrder’ was used in the task settings, the Company/SalesOrders/SalesOrder/AccountReference node will be returned for each SalesOrder node in the input file.</li>
  <li><strong>To</strong> - The name of the field to output the result of the From query to. In the first row in the example above, the AccountReference field from the input file will be mapped to the ‘A/C Ref’ field in the output file.</li>
  <li><strong>Type</strong> - The type of the data. In most cases ‘String’ will be an appropriate choice. This will treat the field as a piece of text and output it ‘as is’.</li>
  <li><strong>Format</strong> - (Optional) The formatting to apply to the data. The result will depend on the data type selected. In the second row in the example above, a date is converted to the ‘mm/DD/yyyy’ format. In the example below, a ‘C’ is used on the last row to convert a decimal field into currency. For more information on formatting, see the links below:
    <ul>
      <li><a href="http://msdn.microsoft.com/en-us/library/dwhawy9k.aspx">Numeric Formatting</a></li>
      <li><a href="http://msdn.microsoft.com/en-us/library/az4se3k1.aspx">Date Time Formatting</a></li>
    </ul>
  </li>
</ul>

<p>The ‘Use Default Mapping’ button can be used to clear all the custom mapping settings and return to the default mapping, if required.</p>

<p>The fields will appear in the output file in the same order as they appear in the table. They can be reordered using the up/down buttons on the right.</p>

<p>The mapping shown will produce the following output:</p>

<pre><code class="language-csv">A/C Ref,Order Date,Address 1
INTE001,01/01/2011,i6 Building
</code></pre>

<h2 id="handling-hierarchical-data">Handling Hierarchical Data </h2>
<p>When your XML file contains hierarchical data, you will need to ‘flatten’ this down in the output CSV file. In order to output each order item onto a separate line in the CSV file, the XPath query in the task settings will need to be set to ‘Company/SalesOrders/SalesOrder/SalesOrderItems/Item’. You will then need to use a custom mapping to output the data correctly.</p>

<p><a href="https://s3.amazonaws.com/helpscout.net/docs/assets/565effd4c697915b26a5c620/images/56b47a7dc697914361565b10/file-H6mp4R1pDU.jpg"><img src="https://s3.amazonaws.com/helpscout.net/docs/assets/565effd4c697915b26a5c620/images/56b47a7dc697914361565b10/file-H6mp4R1pDU.jpg" alt="" /></a></p>

<p>Notice how ‘../’ is used in the XPath queries to move back to the parent node. This is required to access the Id, AccountReference and SalesOrderAddress, as they belong to a parent of the Item nodes. Taking the Id as an example, the query executed would be ‘Company/SalesOrders/SalesOrder/SalesOrderItems/Item/../../Id’. The ‘../../’ moves from the Item node back up to the SalesOrder node, which is where the Id is found.</p>

<p>The mapping shown will produce the following output:</p>

<pre><code class="language-csv">ID,A/C Ref,Name,Sku,Quantity,Price
12345,INTE001,Test,TEST01,1,Â£200.00
12345,INTE001,Test,TEST02,1,Â£200.00
</code></pre>

<h2 id="using-predicates">Using Predicates</h2>
<p>Furthermore, you can use predicates to access specific nodes within the mapping. For example, say you have the below XML.</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;Company</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="na">xmlns:xsd=</span><span class="s">"http://www.w3.org/2001/XMLSchema"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Customers&gt;</span>
    <span class="nt">&lt;Customer&gt;</span>
      <span class="nt">&lt;AccountReference&gt;</span>A1D001<span class="nt">&lt;/AccountReference&gt;</span>
      <span class="nt">&lt;CompanyName&gt;</span>A1 Design Services<span class="nt">&lt;/CompanyName&gt;</span>
      <span class="nt">&lt;CustomFields&gt;</span>
        <span class="nt">&lt;CustomField&gt;</span>
          <span class="nt">&lt;Name&gt;</span>FIRST_INV_DATE<span class="nt">&lt;/Name&gt;</span>
          <span class="nt">&lt;Value&gt;</span>02/01/2015 00:00:00<span class="nt">&lt;/Value&gt;</span>
        <span class="nt">&lt;/CustomField&gt;</span>
        <span class="nt">&lt;CustomField&gt;</span>
          <span class="nt">&lt;Name&gt;</span>LAST_INV_DATE<span class="nt">&lt;/Name&gt;</span>
          <span class="nt">&lt;Value&gt;</span>15/03/2015 00:00:00<span class="nt">&lt;/Value&gt;</span>
        <span class="nt">&lt;/CustomField&gt;</span>
      <span class="nt">&lt;/CustomFields&gt;</span>
    <span class="nt">&lt;/Customer&gt;</span>
  <span class="nt">&lt;/Customers&gt;</span>
<span class="nt">&lt;/Company&gt;</span>
</code></pre>
</div>

<p>And you only wanted to retrieve the <code class="highlighter-rouge">LAST_INV_DATE</code> custom field, in your custom mapping you could use <code class="highlighter-rouge">CustomFields/CustomField[Name='LAST_INV_DATE']/Value</code> to retrieve the desired value.</p>

                    <hr>
                    <div class="row">
                        <div class="col-sm-6"><a onclick="history.go(-1)" href="#"><span class="fa fa-arrow-left"></span>Back</a></div>
                        <div class="col-sm-6 text-right"><a href="http://github.com/Zynk-workflow/docs/tree/master/_documentation/Using-Zynk-Section/Converting-XML-files-to-CSV.md"><span class="fa fa-github"></span>Edit on Github</a></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- /#page-content-wrapper -->
</div>
<!-- /#wrapper -->


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<!-- Menu Toggle Script -->
<script>
    $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/js/bootstrap.min.js"></script>



<script>
    var screenWidth = $(window).width();

    // Add .active class to active link + scroll into view
    var pathinfo = location.pathname + location.hash;
    if (screenWidth > 768 && pathinfo != "/")
    {
        var scrollItem = $("#sidebar-wrapper").find("a[href='" + pathinfo + "']")
                .addClass('active')
                .parents().filter("div>ul>li")[0];
        if (scrollItem) {
            scrollItem.scrollIntoView({
                behavior: "smooth",
                block: "start"
            });
        }
    }

    // Add external link icon next to external menu links
    $(".sidebar-nav a[href^=http]")
        .append('<i class="fa fa-external-link" style="margin-left:-15px"></i>');

    $("#menu-toggle").click(function(){
        $("#sidebar-wrapper").scrollTop(0);
        $(this).toggleClass("fa-angle-down");
        $("#wrapper").toggleClass("menu-collapsed");
    });

    if (screenWidth <= 768) {
        $("#menu-toggle").click();            
    }

    //Allow clicking on non-linked headers to jump to its #href
    $("h2,h3,h4").click(function(){
        if (this.id && this.innerHTML.indexOf("<a") == -1) {
            location.href = "#" + this.id;
        }
    });

    
    
    //should no longer be needed now that we're referencing server-side /slug permalinks
(function () {
    "use strict";
    String.prototype.replaceAll = function(search, replacement) {
        var target = this;
        return target.split(search).join(replacement);
    };

    function fixDoubleBracketLinks(cssSelector) {
        var sidebarText = $(cssSelector)[0].innerHTML;
        var matches = sidebarText.match(/\[\[(.+?)\]\]/g);
        var result = sidebarText;
        if(matches != null) {
            for(var i = 0; i < matches.length; i++) {
                var text = matches[i].replaceAll('[[','').replaceAll(']]','');
                result = result.replace(matches[i],
                    '<a href="' +
                    encodeURIComponent(text.replaceAll(' ','-').toLocaleLowerCase()) +
                    '">' + text + '</a>')
            }
            $(cssSelector).html(result);
        }
    }

    fixDoubleBracketLinks('#page-content-wrapper');
    fixDoubleBracketLinks('#sidebar-wrapper');
})();
    
</script>
    
    
    
</body>
</html>
