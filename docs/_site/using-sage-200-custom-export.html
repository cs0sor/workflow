<!DOCTYPE html>
<html lang="en">
<head>
    <title>Using Sage 200 Custom Export</title>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="shortcut icon" type="image/png" href="/images/favicon.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,600,900" rel="stylesheet">
    <link rel="stylesheet" href="css/github.css">
    <link rel="stylesheet" href="css/nav.css">
    <link rel="stylesheet" href="css/sidebar.css">
    <link rel="stylesheet" href="css/style.css">
 </head>
<body>

<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="xcontainer">
        <div class="navbar-header">
            <a class="navbar-brand" title="Go to Zynk.com" href="http://zynk.com"><img class="img-responsive" id="logo-main" src="assets/logo.svg" alt="Click here to visit Zynk.com" /></a>
        </div>
        <div id="myNavbar">
                <ul class="nav navbar-nav navbar-right">
                    <li class="topnav-2"><a href="mailto:support@zynk.com">support@zynk.com</a></li>
                </ul>
        </div>
    </div>
</nav>

<div id="wrapper">

    <!-- Sidebar -->
    <div id="sidebar-wrapper" class="sidebar-nav">
        
        <h1>Zynk Workflow Documentation</h1>
<ul>
  <li><a href="index">Home</a></li>
  <li>[[Introduction]]
    <ul>
      <li>[[Welcome]]</li>
      <li>[[Getting Started]]</li>
      <li>[[Key Concepts]]</li>
      <li>[[Using Zynk]]</li>
      <li>[[Settings]]</li>
      <li>[[Extensions]]</li>
      <li>[[Integrations]]</li>
    </ul>
  </li>
  <li>[[Accounting]]
    <ul>
      <li>[[Sage 50 UK]]</li>
      <li>[[Sage 200]]</li>
      <li>[[Sage 200 Online]]</li>
      <li>[[Xero]]</li>
      <li>[[Kashflow]]</li>
      <li>[[Quickbooks Online]]</li>
      <li>[[Sage 50 US]]</li>
      <li>[[Brightpearl]]</li>
      <li>[[Sage One]]</li>
      <li>[[Sage 50 Payroll]]</li>
      <li>[[Sage 50 UK Reporting]]</li>
    </ul>
  </li>
  <li>[[CRM]]
    <ul>
      <li>[[ACT]]</li>
      <li>[[AutoTask]]</li>
      <li>[[BXP]]</li>
      <li>[[Campaign Monitor]]</li>
      <li>[[ConnectWise]]</li>
      <li>[[Salesforce]]</li>
      <li>[[Sugar CRM]]</li>
      <li>[[Zoho CRM]]</li>
    </ul>
  </li>
  <li>[[Databases]]
    <ul>
      <li>[[SQL Server]]</li>
      <li>[[SQLite]]</li>
      <li>[[ODBC]]</li>
      <li>[[OLEDB]]</li>
    </ul>
  </li>
  <li>[[Ecommerce]]
    <ul>
      <li>[[Amazon Marketplace]]</li>
      <li>[[Amazon Vendor Central]]</li>
      <li>[[BigCommerce]]</li>
      <li>[[Channel Advisor]]</li>
      <li>[[CoreCommerce]]</li>
      <li>[[Easy Webstore]]</li>
      <li>[[Ebay]]</li>
      <li>[[EKM Powershop]]</li>
      <li>[[Magento V1]]</li>
      <li>[[Magento V2]]</li>
      <li>[[PayPal]]</li>
      <li>[[Shopify]]</li>
      <li>[[WooCommerce]]</li>
    </ul>
  </li>
  <li>[[Files]]
    <ul>
      <li>[[CSV]]</li>
      <li>[[HTML]]</li>
      <li>[[Excel]]</li>
      <li>[[File]]</li>
      <li>[[File Helpers]]</li>
      <li>[[JSON]]</li>
      <li>[[PDF]]</li>
      <li>[[XML and XSLT]]</li>
    </ul>
  </li>
  <li>[[Cloud]]
    <ul>
      <li>[[Amazon S3]]</li>
    </ul>
  </li>
  <li>[[Social]]
    <ul>
      <li>[[LinkedIn]]</li>
      <li>[[Twitter]]</li>
      <li>[[Facebook]]</li>
    </ul>
  </li>
  <li>[[Web]]
    <ul>
      <li>[[Email]]</li>
      <li>[[FTP]]</li>
      <li>[[SFTP]]</li>
      <li>[[HTTP]]</li>
    </ul>
  </li>
  <li>[[Other]]
    <ul>
      <li>[[Developer]]</li>
      <li>[[SMS]]</li>
      <li>[[User Interface]]</li>
      <li>[[WordPress]]</li>
      <li>[[Zynk Core]]</li>
    </ul>
  </li>
  <li>[[Contact Us]]</li>
</ul>

    </div>
    <!-- /#sidebar-wrapper -->

    <!-- Page Content -->
    <div id="page-content-wrapper">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-12 markdown-body">
                    <a onclick="history.go(-1)" href="#"><span class="fa fa-arrow-left"></span>Back</a>
                    <h1>Using Sage 200 Custom Export</h1>
                    <p>This article will show you how to configure your own custom export from Sage 200. In this example, we demonstrate the process of filtering the results of an export and exporting additional fields which are not included in the standard export. We will use the Export Sales Orders task as an example in this tutorial, but the same principles apply across all the Sage 200 export tasks.</p>

<h2 id="filtering-the-export">Filtering the Export</h2>
<p>As an example, we will filter the results of the Export Sales Orders task to only include orders where the total amount is greater than Â£100. Firstly, we need to check the field name in the Sage database. You can do this using SQL Server Management Studio.</p>

<ol>
  <li>Navigate to your Sage 200 database in the Object Explorer, and expand the ‘Tables’ folder.</li>
  <li>Select the table where the data is stored, in the case of sales orders it is ‘SOPOrderReturn’, and expand the ‘Columns’ folder.</li>
  <li>A list of the field names will be displayed. We can see that the total is stored in the ‘TotalGrossValue’ column.</li>
</ol>

<p><img src="https://s3.amazonaws.com/helpscout.net/docs/assets/565effd4c697915b26a5c620/images/56bb61029033607d708f33e5/file-hJbrX2sWLb.png" alt="https://s3.amazonaws.com/helpscout.net/docs/assets/565effd4c697915b26a5c620/images/56bb61029033607d708f33e5/file-hJbrX2sWLb.png" /></p>

<ol>
  <li>In the Export Sales Orders task settings in Zynk, expand the ‘Query Settings’, and click the ‘Where Clauses’ setting.</li>
</ol>

<p><img src="https://s3.amazonaws.com/helpscout.net/docs/assets/565effd4c697915b26a5c620/images/56bb61819033607d708f33eb/file-JgJONlpkkx.png" alt="https://s3.amazonaws.com/helpscout.net/docs/assets/565effd4c697915b26a5c620/images/56bb61819033607d708f33eb/file-JgJONlpkkx.png" /></p>

<ol>
  <li>Set the Comparison to ‘GreaterThan’, the Field Name to ‘SOPOrderReturn.TotalGrossValue’ and the Value to ‘100’.</li>
</ol>

<p><img src="https://s3.amazonaws.com/helpscout.net/docs/assets/565effd4c697915b26a5c620/images/56bb621d9033607d708f33f1/file-tVGtwI99I9.png" alt="https://s3.amazonaws.com/helpscout.net/docs/assets/565effd4c697915b26a5c620/images/56bb621d9033607d708f33f1/file-tVGtwI99I9.png" /></p>

<ol>
  <li>Now when you run the workflow, the task will only export sales orders where the total amount is greater than 100.</li>
</ol>

<h2 id="including-additional-fields-in-the-export">Including Additional Fields in the Export</h2>
<p>As an example, we will include the Total Net, Total Tax and Total Gross fields in the orders returned by the Export Sales Orders task. Firstly, we need to check the field names in the Sage database. You can do this using SQL Server Management Studio.</p>

<ol>
  <li>Navigate to your Sage 200 database in the Object Explorer, and expand the ‘Tables’ folder.</li>
  <li>Select the table where the data is stored, in the case of sales orders it is ‘SOPOrderReturn’, and expand the ‘Columns’ folder.</li>
  <li>A list of the field names will be displayed. We can see that the data is stored in the ‘TotalNetValue’, ‘TotalTaxValue’, and ‘TotalGrossValue’ column.</li>
</ol>

<p><img src="https://s3.amazonaws.com/helpscout.net/docs/assets/565effd4c697915b26a5c620/images/56bb61029033607d708f33e5/file-hJbrX2sWLb.png" alt="https://s3.amazonaws.com/helpscout.net/docs/assets/565effd4c697915b26a5c620/images/56bb61029033607d708f33e5/file-hJbrX2sWLb.png" /></p>

<ol>
  <li>In the Export Sales Orders task settings in Zynk, expand the ‘Query Settings’, and click the ‘Columns’ setting.</li>
</ol>

<p><img src="https://s3.amazonaws.com/helpscout.net/docs/assets/565effd4c697915b26a5c620/images/56bb638dc697917fdc55dbad/file-kCXTkyp72C.png" alt="https://s3.amazonaws.com/helpscout.net/docs/assets/565effd4c697915b26a5c620/images/56bb638dc697917fdc55dbad/file-kCXTkyp72C.png" /></p>

<ol>
  <li>Enter the column names into the list.</li>
</ol>

<p><img src="https://s3.amazonaws.com/helpscout.net/docs/assets/565effd4c697915b26a5c620/images/56b09e869033603f7da3701b/file-FbYshVUdde.png" alt="https://s3.amazonaws.com/helpscout.net/docs/assets/565effd4c697915b26a5c620/images/56b09e869033603f7da3701b/file-FbYshVUdde.png" /></p>

<ol>
  <li>Now when you run the workflow, the task will include these additional fields in the CustomFields collection in the output file.</li>
</ol>

<p><img src="https://s3.amazonaws.com/helpscout.net/docs/assets/565effd4c697915b26a5c620/images/56bb6423c697917fdc55dbb6/file-kHboIbxrV5.png" alt="https://s3.amazonaws.com/helpscout.net/docs/assets/565effd4c697915b26a5c620/images/56bb6423c697917fdc55dbb6/file-kHboIbxrV5.png" /></p>

                    <hr>
                    <div class="row">
                        <div class="col-sm-6"><a onclick="history.go(-1)" href="#"><span class="fa fa-arrow-left"></span>Back</a></div>
                        <div class="col-sm-6 text-right"><a href="http://github.com/Zynk-workflow/docs/tree/master/_documentation/Using-Zynk-Section/Using-Sage-200-Custom-Export.md"><span class="fa fa-github"></span>Edit on Github</a></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- /#page-content-wrapper -->
</div>
<!-- /#wrapper -->


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<!-- Menu Toggle Script -->
<script>
    $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/js/bootstrap.min.js"></script>



<script>
    var screenWidth = $(window).width();

    // Add .active class to active link + scroll into view
    var pathinfo = location.pathname + location.hash;
    if (screenWidth > 768 && pathinfo != "/")
    {
        var scrollItem = $("#sidebar-wrapper").find("a[href='" + pathinfo + "']")
                .addClass('active')
                .parents().filter("div>ul>li")[0];
        if (scrollItem) {
            scrollItem.scrollIntoView({
                behavior: "smooth",
                block: "start"
            });
        }
    }

    // Add external link icon next to external menu links
    $(".sidebar-nav a[href^=http]")
        .append('<i class="fa fa-external-link" style="margin-left:-15px"></i>');

    $("#menu-toggle").click(function(){
        $("#sidebar-wrapper").scrollTop(0);
        $(this).toggleClass("fa-angle-down");
        $("#wrapper").toggleClass("menu-collapsed");
    });

    if (screenWidth <= 768) {
        $("#menu-toggle").click();            
    }

    //Allow clicking on non-linked headers to jump to its #href
    $("h2,h3,h4").click(function(){
        if (this.id && this.innerHTML.indexOf("<a") == -1) {
            location.href = "#" + this.id;
        }
    });

    
    
    //should no longer be needed now that we're referencing server-side /slug permalinks
(function () {
    "use strict";
    String.prototype.replaceAll = function(search, replacement) {
        var target = this;
        return target.split(search).join(replacement);
    };

    function fixDoubleBracketLinks(cssSelector) {
        var sidebarText = $(cssSelector)[0].innerHTML;
        var matches = sidebarText.match(/\[\[(.+?)\]\]/g);
        var result = sidebarText;
        if(matches != null) {
            for(var i = 0; i < matches.length; i++) {
                var text = matches[i].replaceAll('[[','').replaceAll(']]','');
                result = result.replace(matches[i],
                    '<a href="' +
                    encodeURIComponent(text.replaceAll(' ','-').toLocaleLowerCase()) +
                    '">' + text + '</a>')
            }
            $(cssSelector).html(result);
        }
    }

    fixDoubleBracketLinks('#page-content-wrapper');
    fixDoubleBracketLinks('#sidebar-wrapper');
})();
    
</script>
    
    
    
</body>
</html>
