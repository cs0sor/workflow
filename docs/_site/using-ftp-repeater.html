<!DOCTYPE html>
<html lang="en">
<head>
    <title>Using FTP Repeater</title>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="shortcut icon" type="image/png" href="/images/favicon.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,600,900" rel="stylesheet">
    <link rel="stylesheet" href="css/github.css">
    <link rel="stylesheet" href="css/nav.css">
    <link rel="stylesheet" href="css/sidebar.css">
    <link rel="stylesheet" href="css/style.css">
 </head>
<body>

<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="xcontainer">
        <div class="navbar-header">
            <a class="navbar-brand" title="Go to Zynk.com" href="http://zynk.com"><img class="img-responsive" id="logo-main" src="assets/logo.svg" alt="Click here to visit Zynk.com" /></a>
        </div>
        <div id="myNavbar">
                <ul class="nav navbar-nav navbar-right">
                    <li class="topnav-2"><a href="mailto:support@zynk.com">support@zynk.com</a></li>
                </ul>
        </div>
    </div>
</nav>

<div id="wrapper">

    <!-- Sidebar -->
    <div id="sidebar-wrapper" class="sidebar-nav">
        
        <h1>Zynk Workflow Documentation</h1>
<ul>
  <li><a href="index">Home</a></li>
  <li>[[Introduction]]
    <ul>
      <li>[[Welcome]]</li>
      <li>[[Getting Started]]</li>
      <li>[[Key Concepts]]</li>
      <li>[[Using Zynk]]</li>
      <li>[[Settings]]</li>
      <li>[[Extensions]]</li>
      <li>[[Integrations]]</li>
    </ul>
  </li>
  <li>[[Accounting]]
    <ul>
      <li>[[Sage 50 UK]]</li>
      <li>[[Sage 200]]</li>
      <li>[[Sage 200 Online]]</li>
      <li>[[Xero]]</li>
      <li>[[Kashflow]]</li>
      <li>[[Quickbooks Online]]</li>
      <li>[[Sage 50 US]]</li>
      <li>[[Brightpearl]]</li>
      <li>[[Sage One]]</li>
      <li>[[Sage 50 Payroll]]</li>
      <li>[[Sage 50 UK Reporting]]</li>
    </ul>
  </li>
  <li>[[CRM]]
    <ul>
      <li>[[ACT]]</li>
      <li>[[AutoTask]]</li>
      <li>[[BXP]]</li>
      <li>[[Campaign Monitor]]</li>
      <li>[[ConnectWise]]</li>
      <li>[[Salesforce]]</li>
      <li>[[Sugar CRM]]</li>
      <li>[[Zoho CRM]]</li>
    </ul>
  </li>
  <li>[[Databases]]
    <ul>
      <li>[[SQL Server]]</li>
      <li>[[SQLite]]</li>
      <li>[[ODBC]]</li>
      <li>[[OLEDB]]</li>
    </ul>
  </li>
  <li>[[Ecommerce]]
    <ul>
      <li>[[Amazon Marketplace]]</li>
      <li>[[Amazon Vendor Central]]</li>
      <li>[[BigCommerce]]</li>
      <li>[[Channel Advisor]]</li>
      <li>[[CoreCommerce]]</li>
      <li>[[Easy Webstore]]</li>
      <li>[[Ebay]]</li>
      <li>[[EKM Powershop]]</li>
      <li>[[Magento V1]]</li>
      <li>[[Magento V2]]</li>
      <li>[[PayPal]]</li>
      <li>[[Shopify]]</li>
      <li>[[WooCommerce]]</li>
    </ul>
  </li>
  <li>[[Files]]
    <ul>
      <li>[[CSV]]</li>
      <li>[[HTML]]</li>
      <li>[[Excel]]</li>
      <li>[[File]]</li>
      <li>[[File Helpers]]</li>
      <li>[[JSON]]</li>
      <li>[[PDF]]</li>
      <li>[[XML and XSLT]]</li>
    </ul>
  </li>
  <li>[[Cloud]]
    <ul>
      <li>[[Amazon S3]]</li>
    </ul>
  </li>
  <li>[[Social]]
    <ul>
      <li>[[LinkedIn]]</li>
      <li>[[Twitter]]</li>
      <li>[[Facebook]]</li>
    </ul>
  </li>
  <li>[[Web]]
    <ul>
      <li>[[Email]]</li>
      <li>[[FTP]]</li>
      <li>[[SFTP]]</li>
      <li>[[HTTP]]</li>
    </ul>
  </li>
  <li>[[Other]]
    <ul>
      <li>[[Developer]]</li>
      <li>[[SMS]]</li>
      <li>[[User Interface]]</li>
      <li>[[WordPress]]</li>
      <li>[[Zynk Core]]</li>
    </ul>
  </li>
  <li>[[Contact Us]]</li>
</ul>

    </div>
    <!-- /#sidebar-wrapper -->

    <!-- Page Content -->
    <div id="page-content-wrapper">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-12 markdown-body">
                    <a onclick="history.go(-1)" href="#"><span class="fa fa-arrow-left"></span>Back</a>
                    <h1>Using FTP Repeater</h1>
                    <p>The FTP Repeater task will allow you to run a series of sub-tasks against all the files in the directory on the remote server. This tutorial will show you how to use the context variables within the repeater, and to download and remove files fromthe remote server.  You can download the <a href="https://github.com/zynksoftware/samples/tree/master/Workflow%20Samples">sample workflow here</a>,or build the workflow manually using the instructions below.</p>

<p>The repeater could be used if you have a system that outputs data to an FTP site e.g. new orders are written out in XML format.  Zynk can list all the files in the directory, and for each of files run any required sub-tasks e.g. download            the file and import into another system.</p>

<p>To use the sample workflow you will need to have access to an FTP server, and have the required credentials to hand.  Edit the workflow variables, and set your details for <code class="highlighter-rouge">FTP_SERVER</code>, <code class="highlighter-rouge">FTP_USERNAME</code>, <code class="highlighter-rouge">FTP_PASSWORD</code> and <code class="highlighter-rouge">FTP_DIRECTORY</code>.</p>

<p>The first task in the repeater will list all the context variables available to the sub-tasks, it will write a line out for each file found in the directory.  Using the example of download orders from a site, the second and third tasks in the repeater (you will have to enable these) will download any files as orders.xml, and remove the file from the FTP site.  Note enabling the delete task will remove files stored on  your FTP site, make sure you are using this on a test environment.</p>

<h2 id="building-the-workflow">Building the Workflow</h2>
<ol>
  <li>Open Zynk and click on the New Workflow button or choose File &gt; New from the main menu</li>
  <li>Optionally add workflow variables for <code class="highlighter-rouge">FTP_SERVER</code>, <code class="highlighter-rouge">FTP_USERNAME</code>, <code class="highlighter-rouge">FTP_PASSWORD</code> and <code class="highlighter-rouge">FTP_DIRECTORY</code></li>
  <li>You should now see the Task Library pane displayed, Click on the FTP Library and then Double-click (or Drag and drop) the FTP Repeater to copy that task into the Tasks List</li>
  <li>Set the Server, Username, Password and Directory values, optionally using the variables if you configured these in step 2</li>
  <li>Locate the User Interface Library in the Task Library pane and add the Log Info Message task to the Task Builder</li>
  <li>Set the Input to the code below, ensuring to select Use Razor</li>
  <li>Locate the FTP Library in the Task Library pane and add the FTP Download task to the Task Builder</li>
  <li>Set the details as per step 4, and set the File Name to @Context.Current[“Name”], using Razor.  Set the Output File to orders.xml</li>
  <li>Locate the FTP Library in the Task Library pane and add the FTP Delete task to the Task Builder</li>
  <li>Set the details as per step 4, and set the Filename to @Context.Current[“Name”], using Razor</li>
</ol>

<p>Code for Log Info Message Input</p>

<div class="language-cs highlighter-rouge"><pre class="highlight"><code><span class="err">@</span><span class="p">{</span>
    <span class="n">Response</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="nf">Format</span><span class="p">(</span><span class="s">"{0} - {1} - {2} - {3} - {4}"</span><span class="p">,</span>
    <span class="n">Context</span><span class="p">.</span><span class="n">Current</span><span class="p">[</span><span class="s">"Name"</span><span class="p">],</span>
    <span class="n">Context</span><span class="p">.</span><span class="n">Current</span><span class="p">[</span><span class="s">"Extension"</span><span class="p">],</span>
    <span class="n">Context</span><span class="p">.</span><span class="n">Current</span><span class="p">[</span><span class="s">"NameWithoutExtension"</span><span class="p">],</span>
    <span class="n">Context</span><span class="p">.</span><span class="n">Current</span><span class="p">[</span><span class="s">"Directory"</span><span class="p">],</span>
    <span class="n">Context</span><span class="p">.</span><span class="n">Current</span><span class="p">[</span><span class="s">"Server"</span><span class="p">]</span>
    <span class="p">));</span>
<span class="p">}</span>
</code></pre>
</div>

                    <hr>
                    <div class="row">
                        <div class="col-sm-6"><a onclick="history.go(-1)" href="#"><span class="fa fa-arrow-left"></span>Back</a></div>
                        <div class="col-sm-6 text-right"><a href="http://github.com/Zynk-workflow/docs/tree/master/_documentation/Using-Zynk-Section/Using-FTP-Repeater.md"><span class="fa fa-github"></span>Edit on Github</a></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- /#page-content-wrapper -->
</div>
<!-- /#wrapper -->


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<!-- Menu Toggle Script -->
<script>
    $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/js/bootstrap.min.js"></script>



<script>
    var screenWidth = $(window).width();

    // Add .active class to active link + scroll into view
    var pathinfo = location.pathname + location.hash;
    if (screenWidth > 768 && pathinfo != "/")
    {
        var scrollItem = $("#sidebar-wrapper").find("a[href='" + pathinfo + "']")
                .addClass('active')
                .parents().filter("div>ul>li")[0];
        if (scrollItem) {
            scrollItem.scrollIntoView({
                behavior: "smooth",
                block: "start"
            });
        }
    }

    // Add external link icon next to external menu links
    $(".sidebar-nav a[href^=http]")
        .append('<i class="fa fa-external-link" style="margin-left:-15px"></i>');

    $("#menu-toggle").click(function(){
        $("#sidebar-wrapper").scrollTop(0);
        $(this).toggleClass("fa-angle-down");
        $("#wrapper").toggleClass("menu-collapsed");
    });

    if (screenWidth <= 768) {
        $("#menu-toggle").click();            
    }

    //Allow clicking on non-linked headers to jump to its #href
    $("h2,h3,h4").click(function(){
        if (this.id && this.innerHTML.indexOf("<a") == -1) {
            location.href = "#" + this.id;
        }
    });

    
    
    //should no longer be needed now that we're referencing server-side /slug permalinks
(function () {
    "use strict";
    String.prototype.replaceAll = function(search, replacement) {
        var target = this;
        return target.split(search).join(replacement);
    };

    function fixDoubleBracketLinks(cssSelector) {
        var sidebarText = $(cssSelector)[0].innerHTML;
        var matches = sidebarText.match(/\[\[(.+?)\]\]/g);
        var result = sidebarText;
        if(matches != null) {
            for(var i = 0; i < matches.length; i++) {
                var text = matches[i].replaceAll('[[','').replaceAll(']]','');
                result = result.replace(matches[i],
                    '<a href="' +
                    encodeURIComponent(text.replaceAll(' ','-').toLocaleLowerCase()) +
                    '">' + text + '</a>')
            }
            $(cssSelector).html(result);
        }
    }

    fixDoubleBracketLinks('#page-content-wrapper');
    fixDoubleBracketLinks('#sidebar-wrapper');
})();
    
</script>
    
    
    
</body>
</html>
