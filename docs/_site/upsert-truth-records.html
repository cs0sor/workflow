<!DOCTYPE html>
<html lang="en">
<head>
    <title>Upsert Truth Records</title>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="shortcut icon" type="image/png" href="/images/favicon.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,600,900" rel="stylesheet">
    <link rel="stylesheet" href="css/github.css">
    <link rel="stylesheet" href="css/nav.css">
    <link rel="stylesheet" href="css/sidebar.css">
    <link rel="stylesheet" href="css/style.css">
 </head>
<body>

<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="xcontainer">
        <div class="navbar-header">
            <a class="navbar-brand" title="Go to Zynk.com" href="http://zynk.com"><img class="img-responsive" id="logo-main" src="assets/logo.svg" alt="Click here to visit Zynk.com" /></a>
        </div>
        <div id="myNavbar">
                <ul class="nav navbar-nav navbar-right">
                    <li class="topnav-2"><a href="mailto:support@zynk.com">support@zynk.com</a></li>
                </ul>
        </div>
    </div>
</nav>

<div id="wrapper">

    <!-- Sidebar -->
    <div id="sidebar-wrapper" class="sidebar-nav">
        
        <h1>Zynk Workflow Documentation</h1>
<ul>
  <li><a href="index">Home</a>
    <ul>
      <li>[[Getting Started]]</li>
      <li>[[Key Concepts]]</li>
      <li>[[Using Zynk]]</li>
      <li>[[Settings]]</li>
      <li>[[Extensions]]</li>
      <li>[[Integrations]]</li>
    </ul>
  </li>
  <li>[[Accounting]]
    <ul>
      <li>[[Sage 50 UK]]</li>
      <li>[[Sage 200]]</li>
      <li>[[Sage 200 Online]]</li>
      <li>[[Xero]]</li>
      <li>[[Kashflow]]</li>
      <li>[[Quickbooks Online]]</li>
      <li>[[Sage 50 US]]</li>
      <li>[[Brightpearl]]</li>
      <li>[[Sage One]]</li>
      <li>[[Sage 50 Payroll]]</li>
      <li>[[Sage 50 UK Reporting]]</li>
    </ul>
  </li>
  <li>[[CRM]]
    <ul>
      <li>[[ACT]]</li>
      <li>[[AutoTask]]</li>
      <li>[[BXP]]</li>
      <li>[[Campaign Monitor]]</li>
      <li>[[ConnectWise]]</li>
      <li>[[Salesforce]]</li>
      <li>[[Sugar CRM]]</li>
      <li>[[Zoho CRM]]</li>
    </ul>
  </li>
  <li>[[Databases]]
    <ul>
      <li>[[SQL Server]]</li>
      <li>[[SQLite]]</li>
      <li>[[ODBC]]</li>
      <li>[[OLEDB]]</li>
    </ul>
  </li>
  <li>[[Ecommerce]]
    <ul>
      <li>[[Amazon Marketplace]]</li>
      <li>[[Amazon Vendor Central]]</li>
      <li>[[BigCommerce]]</li>
      <li>[[Channel Advisor]]</li>
      <li>[[CoreCommerce]]</li>
      <li>[[Easy Webstore]]</li>
      <li>[[Ebay]]</li>
      <li>[[EKM Powershop]]</li>
      <li>[[Magento V1]]</li>
      <li>[[Magento V2]]</li>
      <li>[[PayPal]]</li>
      <li>[[Shopify]]</li>
      <li>[[WooCommerce]]</li>
    </ul>
  </li>
  <li>[[Files]]
    <ul>
      <li>[[CSV]]</li>
      <li>[[HTML]]</li>
      <li>[[Excel]]</li>
      <li>[[File]]</li>
      <li>[[File Helpers]]</li>
      <li>[[JSON]]</li>
      <li>[[PDF]]</li>
      <li>[[XML and XSLT]]</li>
    </ul>
  </li>
  <li>[[Cloud]]
    <ul>
      <li>[[Amazon S3]]</li>
    </ul>
  </li>
  <li>[[Social]]
    <ul>
      <li>[[LinkedIn]]</li>
      <li>[[Twitter]]</li>
      <li>[[Facebook]]</li>
    </ul>
  </li>
  <li>[[Web]]
    <ul>
      <li>[[Email]]</li>
      <li>[[FTP]]</li>
      <li>[[SFTP]]</li>
      <li>[[HTTP]]</li>
    </ul>
  </li>
  <li>[[Other]]
    <ul>
      <li>[[Developer]]</li>
      <li>[[SMS]]</li>
      <li>[[User Interface]]</li>
      <li>[[WordPress]]</li>
      <li>[[Zynk Core]]</li>
    </ul>
  </li>
  <li>[[Contact Us]]</li>
</ul>

    </div>
    <!-- /#sidebar-wrapper -->

    <!-- Page Content -->
    <div id="page-content-wrapper">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-12 markdown-body">
                    <a onclick="history.go(-1)" href="#"><span class="fa fa-arrow-left"></span>Back</a>
                    <h1>Upsert Truth Records</h1>
                    <p>This task will insert or update records in the truth table (as seen on the ‘Data’ tab) to an XML file. The truth table maps the ID numbers of records imported using Zynk between two systems. The ‘Internal ID’ is usually the ID of the record in Sage, and the external ID is the ID of the matching record from an external system such as a website or e-commerce platform. Note: the truth table is automatically populated when importing data into Sage, so this task is only required when not importing data into Sage.</p>

<h2 id="settings">Settings</h2>
<h3 id="external-id">External ID</h3>
<p><em>Required</em><br />
The XPath query to use to access the external ID of each record. This should be relative to the query used in the ‘XPath’ setting.</p>

<h3 id="internal-id">Internal ID</h3>
<p><em>Required</em><br />
The XPath query to use to access the internal ID of each record. This should be relative to the query used in the ‘XPath’ setting.</p>

<h3 id="xpath">XPath</h3>
<p><em>Required</em><br />
The XPath query to use to access each record in the input file.</p>

<h3 id="input-file">Input File</h3>
<p><em>Required</em><br />
The XML file containing the data to insert or update in the truth table. The data can be stored in any format, the task will read the internal and external IDs based on the XPath settings.</p>

<h3 id="record-type">Record Type</h3>
<p><em>Required</em><br />
The type of records to import into the truth table. Defaults to ‘Contacts’.</p>

<h3 id="update-id">Update ID</h3>
<p><em>Required</em><br />
The ID to update. Select either ‘Internal’ or ‘External’. Defaults to ‘Internal’.</p>

<h3 id="workflow-id">Workflow ID</h3>
<p><em>Optional</em><br />
The ID of the workflow to export truth records for. You can view the ID of a workflow from the ‘Properties’ tab, under ‘Workflow Settings’. If left blank, the task will output truth records for the workflow it is on.</p>

<h3 id="zynk-settings">Zynk Settings</h3>
<p>See <a href="common-task-settings">Common Task Settings</a></p>

<h2 id="examples">Examples</h2>
<p>Sample input file, showing a customer:</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0"?&gt;</span>
<span class="nt">&lt;Customers</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="na">xmlns:xsd=</span><span class="s">"http://www.w3.org/2001/XMLSchema"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Customer&gt;</span>
        <span class="nt">&lt;id&gt;</span>1<span class="nt">&lt;/id&gt;</span>
        <span class="nt">&lt;firstname&gt;</span>John<span class="nt">&lt;/firstname&gt;</span>
        <span class="nt">&lt;lastname&gt;</span>Smith<span class="nt">&lt;/lastname&gt;</span>
        <span class="nt">&lt;account_ref&gt;</span>JOHN001<span class="nt">&lt;/account_ref&gt;</span>
        <span class="nt">&lt;email&gt;</span>john.smith@example.com<span class="nt">&lt;/email&gt;</span>
        <span class="nt">&lt;default_billing_address&gt;</span>
            <span class="nt">&lt;company&gt;</span>Zynk Software<span class="nt">&lt;/company&gt;</span>
            <span class="nt">&lt;street1&gt;</span>Nelson House<span class="nt">&lt;/street1&gt;</span>
            <span class="nt">&lt;street2&gt;</span>Fleming Business Centre<span class="nt">&lt;/street2&gt;</span>
            <span class="nt">&lt;city&gt;</span>Jesmond<span class="nt">&lt;/city&gt;</span>
            <span class="nt">&lt;region&gt;</span>Tyne and Wear<span class="nt">&lt;/region&gt;</span>
            <span class="nt">&lt;country_id&gt;</span>GB<span class="nt">&lt;/country_id&gt;</span>
            <span class="nt">&lt;postcode&gt;</span>NE2 3AE<span class="nt">&lt;/postcode&gt;</span>
        <span class="nt">&lt;/default_billing_address&gt;</span>
    <span class="nt">&lt;/Customer&gt;</span>
<span class="nt">&lt;/Customers&gt;</span>
</code></pre>
</div>

<p>Based on this file, the tasks settings would be set as follows:</p>

<ul>
  <li>XPath - <code class="highlighter-rouge">Customers/Customer</code></li>
  <li>Internal Id - <code class="highlighter-rouge">account_ref</code></li>
  <li>External Id - <code class="highlighter-rouge">id</code></li>
  <li>Record Type - <code class="highlighter-rouge">Customers</code></li>
</ul>


                    <hr>
                    <div class="row">
                        <div class="col-sm-6"><a onclick="history.go(-1)" href="#"><span class="fa fa-arrow-left"></span>Back</a></div>
                        <div class="col-sm-6 text-right"><a href="http://github.com/workflow/docs/tree/master/_documentation/Zynk-Core-Connector/Upsert-Truth-Records.md"><span class="fa fa-github"></span>Edit on Github</a></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- /#page-content-wrapper -->
</div>
<!-- /#wrapper -->


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<!-- Menu Toggle Script -->
<script>
    $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/js/bootstrap.min.js"></script>



<script>
    var screenWidth = $(window).width();

    // Add .active class to active link + scroll into view
    var pathinfo = location.pathname + location.hash;
    if (screenWidth > 768 && pathinfo != "/")
    {
        var scrollItem = $("#sidebar-wrapper").find("a[href='" + pathinfo + "']")
                .addClass('active')
                .parents().filter("div>ul>li")[0];
        if (scrollItem) {
            scrollItem.scrollIntoView({
                behavior: "smooth",
                block: "start"
            });
        }
    }

    // Add external link icon next to external menu links
    $(".sidebar-nav a[href^=http]")
        .append('<i class="fa fa-external-link" style="margin-left:-15px"></i>');

    $("#menu-toggle").click(function(){
        $("#sidebar-wrapper").scrollTop(0);
        $(this).toggleClass("fa-angle-down");
        $("#wrapper").toggleClass("menu-collapsed");
    });

    if (screenWidth <= 768) {
        $("#menu-toggle").click();            
    }

    //Allow clicking on non-linked headers to jump to its #href
    $("h2,h3,h4").click(function(){
        if (this.id && this.innerHTML.indexOf("<a") == -1) {
            location.href = "#" + this.id;
        }
    });

    
    
    //should no longer be needed now that we're referencing server-side /slug permalinks
(function () {
    "use strict";
    String.prototype.replaceAll = function(search, replacement) {
        var target = this;
        return target.split(search).join(replacement);
    };

    function fixDoubleBracketLinks(cssSelector) {
        var sidebarText = $(cssSelector)[0].innerHTML;
        var matches = sidebarText.match(/\[\[(.+?)\]\]/g);
        var result = sidebarText;
        if(matches != null) {
            for(var i = 0; i < matches.length; i++) {
                var text = matches[i].replaceAll('[[','').replaceAll(']]','');
                result = result.replace(matches[i],
                    '<a href="' +
                    encodeURIComponent(text.replaceAll(' ','-').toLocaleLowerCase()) +
                    '">' + text + '</a>')
            }
            $(cssSelector).html(result);
        }
    }

    fixDoubleBracketLinks('#page-content-wrapper');
    fixDoubleBracketLinks('#sidebar-wrapper');
})();
    
</script>
    
    
    
</body>
</html>
