<!DOCTYPE html>
<html lang="en">
<head>
    <title>File Helpers   Basics</title>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="shortcut icon" type="image/png" href="/images/favicon.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,600,900" rel="stylesheet">
    <link rel="stylesheet" href="css/github.css">
    <link rel="stylesheet" href="css/nav.css">
    <link rel="stylesheet" href="css/sidebar.css">
    <link rel="stylesheet" href="css/style.css">
 </head>
<body>

<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="xcontainer">
        <div class="navbar-header">
            <a class="navbar-brand" title="Go to Zynk.com" href="http://zynk.com"><img class="img-responsive" id="logo-main" src="assets/logo.svg" alt="Click here to visit Zynk.com" /></a>
        </div>
        <div id="myNavbar">
                <ul class="nav navbar-nav navbar-right">
                    <li class="topnav-2"><a href="mailto:support@zynk.com">support@zynk.com</a></li>
                </ul>
        </div>
    </div>
</nav>

<div id="wrapper">

    <!-- Sidebar -->
    <div id="sidebar-wrapper" class="sidebar-nav">
        
        <h1>Zynk Workflow Documentation</h1>
<ul>
  <li><a href="index">Home</a></li>
  <li>[[Introduction]]
    <ul>
      <li>[[Welcome]]</li>
      <li>[[Getting Started]]</li>
      <li>[[Key Concepts]]</li>
      <li>[[Using Zynk]]</li>
      <li>[[Settings]]</li>
      <li>[[Extensions]]</li>
      <li>[[Integrations]]</li>
    </ul>
  </li>
  <li>[[Accounting]]
    <ul>
      <li>[[Sage 50 UK]]</li>
      <li>[[Sage 200]]</li>
      <li>[[Sage 200 Online]]</li>
      <li>[[Xero]]</li>
      <li>[[Kashflow]]</li>
      <li>[[Quickbooks Online]]</li>
      <li>[[Sage 50 US]]</li>
      <li>[[Brightpearl]]</li>
      <li>[[Sage One]]</li>
      <li>[[Sage 50 Payroll]]</li>
      <li>[[Sage 50 UK Reporting]]</li>
    </ul>
  </li>
  <li>[[CRM]]
    <ul>
      <li>[[ACT]]</li>
      <li>[[AutoTask]]</li>
      <li>[[BXP]]</li>
      <li>[[Campaign Monitor]]</li>
      <li>[[ConnectWise]]</li>
      <li>[[Salesforce]]</li>
      <li>[[Sugar CRM]]</li>
      <li>[[Zoho CRM]]</li>
    </ul>
  </li>
  <li>[[Databases]]
    <ul>
      <li>[[SQL Server]]</li>
      <li>[[SQLite]]</li>
      <li>[[ODBC]]</li>
      <li>[[OLEDB]]</li>
    </ul>
  </li>
  <li>[[Ecommerce]]
    <ul>
      <li>[[Amazon Marketplace]]</li>
      <li>[[Amazon Vendor Central]]</li>
      <li>[[BigCommerce]]</li>
      <li>[[Channel Advisor]]</li>
      <li>[[CoreCommerce]]</li>
      <li>[[Easy Webstore]]</li>
      <li>[[Ebay]]</li>
      <li>[[EKM Powershop]]</li>
      <li>[[Magento V1]]</li>
      <li>[[Magento V2]]</li>
      <li>[[PayPal]]</li>
      <li>[[Shopify]]</li>
      <li>[[WooCommerce]]</li>
    </ul>
  </li>
  <li>[[Files]]
    <ul>
      <li>[[CSV]]</li>
      <li>[[HTML]]</li>
      <li>[[Excel]]</li>
      <li>[[File]]</li>
      <li>[[File Helpers]]</li>
      <li>[[JSON]]</li>
      <li>[[PDF]]</li>
      <li>[[XML and XSLT]]</li>
    </ul>
  </li>
  <li>[[Cloud]]
    <ul>
      <li>[[Amazon S3]]</li>
    </ul>
  </li>
  <li>[[Social]]
    <ul>
      <li>[[LinkedIn]]</li>
      <li>[[Twitter]]</li>
      <li>[[Facebook]]</li>
    </ul>
  </li>
  <li>[[Web]]
    <ul>
      <li>[[Email]]</li>
      <li>[[FTP]]</li>
      <li>[[SFTP]]</li>
      <li>[[HTTP]]</li>
    </ul>
  </li>
  <li>[[Other]]
    <ul>
      <li>[[Developer]]</li>
      <li>[[SMS]]</li>
      <li>[[User Interface]]</li>
      <li>[[WordPress]]</li>
      <li>[[Zynk Core]]</li>
    </ul>
  </li>
  <li>[[Contact Us]]</li>
</ul>

    </div>
    <!-- /#sidebar-wrapper -->

    <!-- Page Content -->
    <div id="page-content-wrapper">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-12 markdown-body">
                    <a onclick="history.go(-1)" href="#"><span class="fa fa-arrow-left"></span>Back</a>
                    <h1>File Helpers   Basics</h1>
                    <p>This article is an introduction to using the FileHelpers Module within Zynk, based on the Easy Example on the <a href="http://www.filehelpers.com/example\_easy.html">FileHelperssite</a>.  Using a C# class you can read in data from a flat file format and convertto XML, which can then be used for further processing within Zynk Workflows e.g. with the XSLT Transform.</p>

<p>More information on this task can be found on the <a href="basic-converter">Basic Converter</a> article.</p>

<h2 id="input-file">Input File</h2>
<p>Save the below to input.txt</p>

<pre><code class="language-CSV">10248|VINET|04071996|32.38 10249|TOMSP|05071996|11.61  
10250|HANAR|08071996|65.83 10251|VICTE|08071996|41.34
</code></pre>

<h2 id="c-class">C# Class</h2>
<p>Save the below to class.cs</p>

<div class="language-cs highlighter-rouge"><pre class="highlight"><code><span class="na">[DelimitedRecord("|")]</span> 
<span class="k">public</span> <span class="k">class</span> <span class="nc">Orders</span>  
<span class="p">{</span> 	
    <span class="k">public</span> <span class="kt">int</span> <span class="n">OrderID</span><span class="p">;</span> 	
    <span class="k">public</span> <span class="kt">string</span> <span class="n">CustomerID</span><span class="p">;</span> 	
    
    <span class="p">[</span><span class="nf">FieldConverter</span><span class="p">(</span><span class="n">ConverterKind</span><span class="p">.</span><span class="n">Date</span><span class="p">,</span> <span class="s">"ddMMyyyy"</span><span class="p">)]</span>    	
    <span class="k">public</span> <span class="n">DateTime</span> <span class="n">OrderDate</span><span class="p">;</span>  	
    
    <span class="k">public</span> <span class="kt">decimal</span> <span class="n">Freight</span><span class="p">;</span> 
<span class="p">}</span>
</code></pre>
</div>

<h2 id="zynk-settings">Zynk Settings</h2>
<p>Create a new Workflow in Zynk, and drag on the Basic Converter task from the File Helpers folder.  Set the following            settings on the task.</p>

<h3 id="convert-settings">Convert Settings</h3>
<p>Path to class.cs (ensure the data type is changed to File)</p>

<h3 id="error-file">Error File</h3>
<p>error.txt</p>

<h3 id="input-file-1">Input File</h3>
<p>Path to input.txt</p>

<h3 id="output-file">Output File</h3>
<p>output.xml</p>

<h2 id="output-xml">Output XML</h2>
<p>After saving and running the Workflow, the output.xml file should contain the following XML representation of the data from            the input file.</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0"?&gt;</span>
<span class="nt">&lt;ArrayOfAnyType</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;anyType</span> <span class="na">xsi:type=</span><span class="s">"Orders"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;OrderID&gt;</span>10248<span class="nt">&lt;/OrderID&gt;</span>
		<span class="nt">&lt;CustomerID&gt;</span>VINET<span class="nt">&lt;/CustomerID&gt;</span>
		<span class="nt">&lt;OrderDate&gt;</span>1996-07-04T00:00:00<span class="nt">&lt;/OrderDate&gt;</span>
		<span class="nt">&lt;Freight&gt;</span>32.38<span class="nt">&lt;/Freight&gt;</span>
	<span class="nt">&lt;/anyType&gt;</span>
	<span class="nt">&lt;anyType</span> <span class="na">xsi:type=</span><span class="s">"Orders"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;OrderID&gt;</span>10249<span class="nt">&lt;/OrderID&gt;</span>
		<span class="nt">&lt;CustomerID&gt;</span>TOMSP<span class="nt">&lt;/CustomerID&gt;</span>
		<span class="nt">&lt;OrderDate&gt;</span>1996-07-05T00:00:00<span class="nt">&lt;/OrderDate&gt;</span>
		<span class="nt">&lt;Freight&gt;</span>11.61<span class="nt">&lt;/Freight&gt;</span>
	<span class="nt">&lt;/anyType&gt;</span>
	<span class="nt">&lt;anyType</span> <span class="na">xsi:type=</span><span class="s">"Orders"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;OrderID&gt;</span>10250<span class="nt">&lt;/OrderID&gt;</span>
		<span class="nt">&lt;CustomerID&gt;</span>HANAR<span class="nt">&lt;/CustomerID&gt;</span>
		<span class="nt">&lt;OrderDate&gt;</span>1996-07-08T00:00:00<span class="nt">&lt;/OrderDate&gt;</span>
		<span class="nt">&lt;Freight&gt;</span>65.83<span class="nt">&lt;/Freight&gt;</span>
	<span class="nt">&lt;/anyType&gt;</span>
	<span class="nt">&lt;anyType</span> <span class="na">xsi:type=</span><span class="s">"Orders"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;OrderID&gt;</span>10251<span class="nt">&lt;/OrderID&gt;</span>
		<span class="nt">&lt;CustomerID&gt;</span>VICTE<span class="nt">&lt;/CustomerID&gt;</span>
		<span class="nt">&lt;OrderDate&gt;</span>1996-07-08T00:00:00<span class="nt">&lt;/OrderDate&gt;</span>
		<span class="nt">&lt;Freight&gt;</span>41.34<span class="nt">&lt;/Freight&gt;</span>
	<span class="nt">&lt;/anyType&gt;</span>
<span class="nt">&lt;/ArrayOfAnyType&gt;</span>
</code></pre>
</div>

<h2 id="errors">Errors</h2>
<p>If there are any errors during the convert they will be written out to the errors file if one is provided.  For example            introducing an invalid character to the date column would cause the following output.</p>

<p>FileHelpers - Errors Saved at 13 February 2015 11:23:19 
LineNumber | LineString |ErrorDescription 
4|”10251|VICTE|0807Z1996|41.34”|In the field ‘OrderDate’: Line: 4. Column: 13. Field: OrderDate. Error Converting ‘0807Z1996’ to type: ‘DateTime’.  There are more chars than in the format string: ‘ddMMyyyy’</p>

                    <hr>
                    <div class="row">
                        <div class="col-sm-6"><a onclick="history.go(-1)" href="#"><span class="fa fa-arrow-left"></span>Back</a></div>
                        <div class="col-sm-6 text-right"><a href="http://github.com/Zynk-workflow/docs/tree/master/_documentation/Getting-Started-Section/File-Helpers---Basics.md"><span class="fa fa-github"></span>Edit on Github</a></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- /#page-content-wrapper -->
</div>
<!-- /#wrapper -->


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<!-- Menu Toggle Script -->
<script>
    $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/js/bootstrap.min.js"></script>



<script>
    var screenWidth = $(window).width();

    // Add .active class to active link + scroll into view
    var pathinfo = location.pathname + location.hash;
    if (screenWidth > 768 && pathinfo != "/")
    {
        var scrollItem = $("#sidebar-wrapper").find("a[href='" + pathinfo + "']")
                .addClass('active')
                .parents().filter("div>ul>li")[0];
        if (scrollItem) {
            scrollItem.scrollIntoView({
                behavior: "smooth",
                block: "start"
            });
        }
    }

    // Add external link icon next to external menu links
    $(".sidebar-nav a[href^=http]")
        .append('<i class="fa fa-external-link" style="margin-left:-15px"></i>');

    $("#menu-toggle").click(function(){
        $("#sidebar-wrapper").scrollTop(0);
        $(this).toggleClass("fa-angle-down");
        $("#wrapper").toggleClass("menu-collapsed");
    });

    if (screenWidth <= 768) {
        $("#menu-toggle").click();            
    }

    //Allow clicking on non-linked headers to jump to its #href
    $("h2,h3,h4").click(function(){
        if (this.id && this.innerHTML.indexOf("<a") == -1) {
            location.href = "#" + this.id;
        }
    });

    
    
    //should no longer be needed now that we're referencing server-side /slug permalinks
(function () {
    "use strict";
    String.prototype.replaceAll = function(search, replacement) {
        var target = this;
        return target.split(search).join(replacement);
    };

    function fixDoubleBracketLinks(cssSelector) {
        var sidebarText = $(cssSelector)[0].innerHTML;
        var matches = sidebarText.match(/\[\[(.+?)\]\]/g);
        var result = sidebarText;
        if(matches != null) {
            for(var i = 0; i < matches.length; i++) {
                var text = matches[i].replaceAll('[[','').replaceAll(']]','');
                result = result.replace(matches[i],
                    '<a href="' +
                    encodeURIComponent(text.replaceAll(' ','-').toLocaleLowerCase()) +
                    '">' + text + '</a>')
            }
            $(cssSelector).html(result);
        }
    }

    fixDoubleBracketLinks('#page-content-wrapper');
    fixDoubleBracketLinks('#sidebar-wrapper');
})();
    
</script>
    
    
    
</body>
</html>
