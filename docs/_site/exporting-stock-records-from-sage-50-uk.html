<!DOCTYPE html>
<html lang="en">
<head>
    <title>Exporting Stock Records from Sage 50 UK</title>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="shortcut icon" type="image/png" href="/images/favicon.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,600,900" rel="stylesheet">
    <link rel="stylesheet" href="css/github.css">
    <link rel="stylesheet" href="css/nav.css">
    <link rel="stylesheet" href="css/sidebar.css">
    <link rel="stylesheet" href="css/style.css">
 </head>
<body>

<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="xcontainer">
        <div class="navbar-header">
            <a class="navbar-brand" title="Go to Zynk.com" href="http://zynk.com"><img class="img-responsive" id="logo-main" src="assets/logo.svg" alt="Click here to visit Zynk.com" /></a>
        </div>
        <div id="myNavbar">
                <ul class="nav navbar-nav navbar-right">
                    <li class="topnav-2"><a href="mailto:support@zynk.com">support@zynk.com</a></li>
                </ul>
        </div>
    </div>
</nav>

<div id="wrapper">

    <!-- Sidebar -->
    <div id="sidebar-wrapper" class="sidebar-nav">
        
        <h1>Zynk Workflow Documentation</h1>
<ul>
  <li><a href="index">Home</a></li>
  <li>[[Introduction]]
    <ul>
      <li>[[Welcome]]</li>
      <li>[[Getting Started]]</li>
      <li>[[Key Concepts]]</li>
      <li>[[Using Zynk]]</li>
      <li>[[Settings]]</li>
      <li>[[Extensions]]</li>
      <li>[[Integrations]]</li>
    </ul>
  </li>
  <li>[[Accounting]]
    <ul>
      <li>[[Sage 50 UK]]</li>
      <li>[[Sage 200]]</li>
      <li>[[Sage 200 Online]]</li>
      <li>[[Xero]]</li>
      <li>[[Kashflow]]</li>
      <li>[[Quickbooks Online]]</li>
      <li>[[Sage 50 US]]</li>
      <li>[[Brightpearl]]</li>
      <li>[[Sage One]]</li>
      <li>[[Sage 50 Payroll]]</li>
      <li>[[Sage 50 UK Reporting]]</li>
    </ul>
  </li>
  <li>[[CRM]]
    <ul>
      <li>[[ACT]]</li>
      <li>[[AutoTask]]</li>
      <li>[[BXP]]</li>
      <li>[[Campaign Monitor]]</li>
      <li>[[ConnectWise]]</li>
      <li>[[Salesforce]]</li>
      <li>[[Sugar CRM]]</li>
      <li>[[Zoho CRM]]</li>
    </ul>
  </li>
  <li>[[Databases]]
    <ul>
      <li>[[SQL Server]]</li>
      <li>[[SQLite]]</li>
      <li>[[ODBC]]</li>
      <li>[[OLEDB]]</li>
    </ul>
  </li>
  <li>[[Ecommerce]]
    <ul>
      <li>[[Amazon Marketplace]]</li>
      <li>[[Amazon Vendor Central]]</li>
      <li>[[BigCommerce]]</li>
      <li>[[Channel Advisor]]</li>
      <li>[[CoreCommerce]]</li>
      <li>[[Easy Webstore]]</li>
      <li>[[Ebay]]</li>
      <li>[[EKM Powershop]]</li>
      <li>[[Magento V1]]</li>
      <li>[[Magento V2]]</li>
      <li>[[PayPal]]</li>
      <li>[[Shopify]]</li>
      <li>[[WooCommerce]]</li>
    </ul>
  </li>
  <li>[[Files]]
    <ul>
      <li>[[CSV]]</li>
      <li>[[HTML]]</li>
      <li>[[Excel]]</li>
      <li>[[File]]</li>
      <li>[[File Helpers]]</li>
      <li>[[JSON]]</li>
      <li>[[PDF]]</li>
      <li>[[XML and XSLT]]</li>
    </ul>
  </li>
  <li>[[Cloud]]
    <ul>
      <li>[[Amazon S3]]</li>
    </ul>
  </li>
  <li>[[Social]]
    <ul>
      <li>[[LinkedIn]]</li>
      <li>[[Twitter]]</li>
      <li>[[Facebook]]</li>
    </ul>
  </li>
  <li>[[Web]]
    <ul>
      <li>[[Email]]</li>
      <li>[[FTP]]</li>
      <li>[[SFTP]]</li>
      <li>[[HTTP]]</li>
    </ul>
  </li>
  <li>[[Other]]
    <ul>
      <li>[[Developer]]</li>
      <li>[[SMS]]</li>
      <li>[[User Interface]]</li>
      <li>[[WordPress]]</li>
      <li>[[Zynk Core]]</li>
    </ul>
  </li>
  <li>[[Contact Us]]</li>
</ul>

    </div>
    <!-- /#sidebar-wrapper -->

    <!-- Page Content -->
    <div id="page-content-wrapper">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-12 markdown-body">
                    <a onclick="history.go(-1)" href="#"><span class="fa fa-arrow-left"></span>Back</a>
                    <h1>Exporting Stock Records from Sage 50 UK</h1>
                    <p>This task will export product information from Sage 50 in Zynk XML format.</p>

<h2 id="settings">Settings</h2>
<h3 id="sage-50-connection">Sage 50 Connection</h3>
<p><em>Required</em><br />
The connection to Sage 50 UK to use.  See the <a href="connecting-to-sage-50-uk">Connecting to Sage 50 UK</a> article if you require more information on how to create/manage connections.</p>

<h3 id="attachment-search-pattern">Attachment Search Pattern</h3>
<p><em>Required</em><br />
File search pattern for attachment export e.g. *.PDF</p>

<h3 id="export-attachments">Export Attachments</h3>
<p><em>Required</em><br />
Set to True if you want the attachments exported from Customers note: this will result in very large XML output files.</p>

<h3 id="export-published-products">Export Published Products</h3>
<p><em>Required</em><br />
Set this value to True if you want to only export products marked as Publish. If set to False it will ignore the published flag and export all records.</p>

<h3 id="export-settings">Export Settings</h3>
<p><em>Required</em></p>

<ul>
  <li><strong>Date Modified</strong> - Only records modified after this date will be exported. The date will update automatically each time the task runs.</li>
  <li><strong>Export Modified, New or All Records</strong> - Used to choose which records should be included in the export. Note that the ‘Modified’ setting will also export any new records.</li>
</ul>

<h3 id="query-settings">Query Settings</h3>
<p><em>Optional</em></p>

<ul>
  <li><strong>Columns</strong> - Allows you to specify additional columns to include in the export.  Additional fields will be exported in the CustomFields section in the XML.  Be sure to include the table name for each of the additional columns provided eg. <code class="highlighter-rouge">[STOCK].[QTY_LAST_STOCK_TAKE]</code>.  If the table that the column you are trying to retrieve is not used by the standard export, you will need to add the table to Joins.</li>
  <li><strong>Joins</strong> - Allows data to be exported from other tables in the Sage database. Required when exporting data from tables not included in the standard export.</li>
  <li><strong>Where Clauses</strong> - Allows filters to be set to limit the data that is exported.</li>
</ul>

<h3 id="query-timeout">Query Timeout</h3>
<p><em>Optional</em><br />
The maximum amount of time (in seconds) the query should be allowed to run.</p>

<h3 id="output-file">Output File</h3>
<p><em>Required</em><br />
The name of the file to export to. Data is exported in Zynk XML format</p>

<h3 id="zynk-settings">Zynk Settings</h3>
<p>See <a href="common-task-settings">Common Task Settings</a></p>

<h2 id="examples">Examples</h2>
<p>Sample output file:</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0"?&gt;</span>
<span class="nt">&lt;Company&gt;</span>
    <span class="nt">&lt;Products&gt;</span>
        <span class="nt">&lt;Product&gt;</span>
            <span class="nt">&lt;UniqueId&gt;</span>FAX001<span class="nt">&lt;/UniqueId&gt;</span>
            <span class="nt">&lt;Sku&gt;</span>FAX001<span class="nt">&lt;/Sku&gt;</span>
            <span class="nt">&lt;Barcode</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;Name&gt;</span>FX010 Plain Paper Fax<span class="nt">&lt;/Name&gt;</span>
            <span class="nt">&lt;Description&gt;</span>FX010 Plain Paper Fax<span class="nt">&lt;/Description&gt;</span>
            <span class="nt">&lt;LongDescription</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;ImageUrl&gt;</span>fax001.jpg<span class="nt">&lt;/ImageUrl&gt;</span>
            <span class="nt">&lt;ThumbnailUrl&gt;</span>fax001.jpg<span class="nt">&lt;/ThumbnailUrl&gt;</span>
            <span class="nt">&lt;Custom1&gt;</span>Business Machines<span class="nt">&lt;/Custom1&gt;</span>
            <span class="nt">&lt;Custom2&gt;</span>Faxes<span class="nt">&lt;/Custom2&gt;</span>
            <span class="nt">&lt;Custom3</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;SalePrice&gt;</span>180<span class="nt">&lt;/SalePrice&gt;</span>
            <span class="nt">&lt;UnitWeight&gt;</span>0<span class="nt">&lt;/UnitWeight&gt;</span>
            <span class="nt">&lt;QtyInStock&gt;</span>0<span class="nt">&lt;/QtyInStock&gt;</span>
            <span class="nt">&lt;QtyOnOrder&gt;</span>0<span class="nt">&lt;/QtyOnOrder&gt;</span>
            <span class="nt">&lt;ReorderQty&gt;</span>1<span class="nt">&lt;/ReorderQty&gt;</span>
            <span class="nt">&lt;ReorderLvl&gt;</span>0<span class="nt">&lt;/ReorderLvl&gt;</span>
            <span class="nt">&lt;TaxCode&gt;</span>1<span class="nt">&lt;/TaxCode&gt;</span>
            <span class="nt">&lt;GroupCode&gt;</span>9<span class="nt">&lt;/GroupCode&gt;</span>
            <span class="nt">&lt;Department&gt;</span>1<span class="nt">&lt;/Department&gt;</span>
            <span class="nt">&lt;UnitOfSale&gt;</span>Each<span class="nt">&lt;/UnitOfSale&gt;</span>
            <span class="nt">&lt;NominalCode&gt;</span>4000<span class="nt">&lt;/NominalCode&gt;</span>
            <span class="nt">&lt;Publish&gt;</span>true<span class="nt">&lt;/Publish&gt;</span>
            <span class="nt">&lt;ProductLevel&gt;</span>0<span class="nt">&lt;/ProductLevel&gt;</span>
            <span class="nt">&lt;SpecialOffer&gt;</span>false<span class="nt">&lt;/SpecialOffer&gt;</span>
            <span class="nt">&lt;QtyAllocated&gt;</span>0<span class="nt">&lt;/QtyAllocated&gt;</span>
            <span class="nt">&lt;ImageName&gt;</span>fax001.jpg<span class="nt">&lt;/ImageName&gt;</span>
            <span class="nt">&lt;LastCostPrice&gt;</span>150<span class="nt">&lt;/LastCostPrice&gt;</span>
            <span class="nt">&lt;QtyLastOrder&gt;</span>0<span class="nt">&lt;/QtyLastOrder&gt;</span>
            <span class="nt">&lt;AverageCostPrice&gt;</span>150<span class="nt">&lt;/AverageCostPrice&gt;</span>
            <span class="nt">&lt;StandardCostPrice</span> <span class="na">xsi:nil=</span><span class="s">"true"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;RRPPrice</span> <span class="na">xsi:nil=</span><span class="s">"true"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;Attachments</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;DateModified</span> <span class="na">xsi:nil=</span><span class="s">"true"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;InactiveDate</span> <span class="na">xsi:nil=</span><span class="s">"true"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;Dimensions</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;ProductBoms</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;RelatedProducts</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;AlternativeProducts</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;SupplierAccountRef&gt;</span>WAL001<span class="nt">&lt;/SupplierAccountRef&gt;</span>
            <span class="nt">&lt;SupplierDepartment&gt;</span>1<span class="nt">&lt;/SupplierDepartment&gt;</span>
            <span class="nt">&lt;ProductQtyBreaks</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;CommodityCode</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;IntrastatCommodityCode</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;PurchaseNominalCode&gt;</span>5000<span class="nt">&lt;/PurchaseNominalCode&gt;</span>
            <span class="nt">&lt;Memo</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;SupplierPartNo&gt;</span>000006876<span class="nt">&lt;/SupplierPartNo&gt;</span>
            <span class="nt">&lt;Location&gt;</span>Supplied Direct<span class="nt">&lt;/Location&gt;</span>
            <span class="nt">&lt;Locations</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;AllowSalesOrder</span> <span class="na">xsi:nil=</span><span class="s">"true"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;Attributes</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;UnitsOfMeasure</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;UseDescriptionOnDocs&gt;</span>false<span class="nt">&lt;/UseDescriptionOnDocs&gt;</span>
            <span class="nt">&lt;ItemType&gt;</span>NonStock<span class="nt">&lt;/ItemType&gt;</span>
            <span class="nt">&lt;FulfilmentMethod</span> <span class="na">xsi:nil=</span><span class="s">"true"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;ProductSuppliers</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;CustomFields</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;AnalysisCodes</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;SearchCategories</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/Product&gt;</span>
    <span class="nt">&lt;/Products&gt;</span>
<span class="nt">&lt;/Company&gt;</span>
</code></pre>
</div>

                    <hr>
                    <div class="row">
                        <div class="col-sm-6"><a onclick="history.go(-1)" href="#"><span class="fa fa-arrow-left"></span>Back</a></div>
                        <div class="col-sm-6 text-right"><a href="http://github.com/Zynk-workflow/docs/tree/master/_documentation/Sage-50-UK-Connector/Exporting-Stock-Records-from-Sage-50-UK.md"><span class="fa fa-github"></span>Edit on Github</a></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- /#page-content-wrapper -->
</div>
<!-- /#wrapper -->


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<!-- Menu Toggle Script -->
<script>
    $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/js/bootstrap.min.js"></script>



<script>
    var screenWidth = $(window).width();

    // Add .active class to active link + scroll into view
    var pathinfo = location.pathname + location.hash;
    if (screenWidth > 768 && pathinfo != "/")
    {
        var scrollItem = $("#sidebar-wrapper").find("a[href='" + pathinfo + "']")
                .addClass('active')
                .parents().filter("div>ul>li")[0];
        if (scrollItem) {
            scrollItem.scrollIntoView({
                behavior: "smooth",
                block: "start"
            });
        }
    }

    // Add external link icon next to external menu links
    $(".sidebar-nav a[href^=http]")
        .append('<i class="fa fa-external-link" style="margin-left:-15px"></i>');

    $("#menu-toggle").click(function(){
        $("#sidebar-wrapper").scrollTop(0);
        $(this).toggleClass("fa-angle-down");
        $("#wrapper").toggleClass("menu-collapsed");
    });

    if (screenWidth <= 768) {
        $("#menu-toggle").click();            
    }

    //Allow clicking on non-linked headers to jump to its #href
    $("h2,h3,h4").click(function(){
        if (this.id && this.innerHTML.indexOf("<a") == -1) {
            location.href = "#" + this.id;
        }
    });

    
    
    //should no longer be needed now that we're referencing server-side /slug permalinks
(function () {
    "use strict";
    String.prototype.replaceAll = function(search, replacement) {
        var target = this;
        return target.split(search).join(replacement);
    };

    function fixDoubleBracketLinks(cssSelector) {
        var sidebarText = $(cssSelector)[0].innerHTML;
        var matches = sidebarText.match(/\[\[(.+?)\]\]/g);
        var result = sidebarText;
        if(matches != null) {
            for(var i = 0; i < matches.length; i++) {
                var text = matches[i].replaceAll('[[','').replaceAll(']]','');
                result = result.replace(matches[i],
                    '<a href="' +
                    encodeURIComponent(text.replaceAll(' ','-').toLocaleLowerCase()) +
                    '">' + text + '</a>')
            }
            $(cssSelector).html(result);
        }
    }

    fixDoubleBracketLinks('#page-content-wrapper');
    fixDoubleBracketLinks('#sidebar-wrapper');
})();
    
</script>
    
    
    
</body>
</html>
