<!DOCTYPE html>
<html lang="en">
<head>
    <title>Using Data Repeaters</title>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="shortcut icon" type="image/png" href="/images/favicon.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,600,900" rel="stylesheet">
    <link rel="stylesheet" href="css/github.css">
    <link rel="stylesheet" href="css/nav.css">
    <link rel="stylesheet" href="css/sidebar.css">
    <link rel="stylesheet" href="css/style.css">
 </head>
<body>

<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="xcontainer">
        <div class="navbar-header">
            <a class="navbar-brand" title="Go to Zynk.com" href="http://zynk.com"><img class="img-responsive" id="logo-main" src="assets/logo.svg" alt="Click here to visit Zynk.com" /></a>
        </div>
        <div id="myNavbar">
                <ul class="nav navbar-nav navbar-right">
                    <li class="topnav-2"><a href="mailto:support@zynk.com">support@zynk.com</a></li>
                </ul>
        </div>
    </div>
</nav>

<div id="wrapper">

    <!-- Sidebar -->
    <div id="sidebar-wrapper" class="sidebar-nav">
        
        <h1>Zynk Workflow Documentation</h1>
<ul>
  <li><a href="index">Home</a></li>
  <li>[[Introduction]]
    <ul>
      <li>[[Welcome]]</li>
      <li>[[Getting Started]]</li>
      <li>[[Key Concepts]]</li>
      <li>[[Using Zynk]]</li>
      <li>[[Settings]]</li>
      <li>[[Extensions]]</li>
      <li>[[Integrations]]</li>
    </ul>
  </li>
  <li>[[Accounting]]
    <ul>
      <li>[[Sage 50 UK]]</li>
      <li>[[Sage 200]]</li>
      <li>[[Sage 200 Online]]</li>
      <li>[[Xero]]</li>
      <li>[[Kashflow]]</li>
      <li>[[Quickbooks Online]]</li>
      <li>[[Sage 50 US]]</li>
      <li>[[Brightpearl]]</li>
      <li>[[Sage One]]</li>
      <li>[[Sage 50 Payroll]]</li>
      <li>[[Sage 50 UK Reporting]]</li>
    </ul>
  </li>
  <li>[[CRM]]
    <ul>
      <li>[[ACT]]</li>
      <li>[[AutoTask]]</li>
      <li>[[BXP]]</li>
      <li>[[Campaign Monitor]]</li>
      <li>[[ConnectWise]]</li>
      <li>[[Salesforce]]</li>
      <li>[[Sugar CRM]]</li>
      <li>[[Zoho CRM]]</li>
    </ul>
  </li>
  <li>[[Databases]]
    <ul>
      <li>[[SQL Server]]</li>
      <li>[[SQLite]]</li>
      <li>[[ODBC]]</li>
      <li>[[OLEDB]]</li>
    </ul>
  </li>
  <li>[[Ecommerce]]
    <ul>
      <li>[[Amazon Marketplace]]</li>
      <li>[[Amazon Vendor Central]]</li>
      <li>[[BigCommerce]]</li>
      <li>[[Channel Advisor]]</li>
      <li>[[CoreCommerce]]</li>
      <li>[[Easy Webstore]]</li>
      <li>[[Ebay]]</li>
      <li>[[EKM Powershop]]</li>
      <li>[[Magento V1]]</li>
      <li>[[Magento V2]]</li>
      <li>[[PayPal]]</li>
      <li>[[Shopify]]</li>
      <li>[[WooCommerce]]</li>
    </ul>
  </li>
  <li>[[Files]]
    <ul>
      <li>[[CSV]]</li>
      <li>[[HTML]]</li>
      <li>[[Excel]]</li>
      <li>[[File]]</li>
      <li>[[File Helpers]]</li>
      <li>[[JSON]]</li>
      <li>[[PDF]]</li>
      <li>[[XML and XSLT]]</li>
    </ul>
  </li>
  <li>[[Cloud]]
    <ul>
      <li>[[Amazon S3]]</li>
    </ul>
  </li>
  <li>[[Social]]
    <ul>
      <li>[[LinkedIn]]</li>
      <li>[[Twitter]]</li>
      <li>[[Facebook]]</li>
    </ul>
  </li>
  <li>[[Web]]
    <ul>
      <li>[[Email]]</li>
      <li>[[FTP]]</li>
      <li>[[SFTP]]</li>
      <li>[[HTTP]]</li>
    </ul>
  </li>
  <li>[[Other]]
    <ul>
      <li>[[Developer]]</li>
      <li>[[SMS]]</li>
      <li>[[User Interface]]</li>
      <li>[[WordPress]]</li>
      <li>[[Zynk Core]]</li>
    </ul>
  </li>
  <li>[[Contact Us]]</li>
</ul>

    </div>
    <!-- /#sidebar-wrapper -->

    <!-- Page Content -->
    <div id="page-content-wrapper">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-12 markdown-body">
                    <a onclick="history.go(-1)" href="#"><span class="fa fa-arrow-left"></span>Back</a>
                    <h1>Using Data Repeaters</h1>
                    <p>In this tutorial we will create a more advanced workflow that queries an XML data set using the [XML Repeater]] (you could also use the [[CSV Repeater]], [[Excel Repeater]], [[SQL Repeater]], [[ODBC Repeater]], [[OLEDB Repeater]] or [<a href="xml-repeater]]-(you-could-also-use-the [[csv-repeater]], [[excel-repeater]], [[sql-repeater]], [[odbc-repeater]], [[oledb-repeater]]-or-[[file-repeater)">File Repeater</a> and we want to output each of the records to our PC as personalised letters which could then be Emailed or sent to PDF for printing.</p>

<p>First we need to create some support files for the tutorial, open your text editor and create the two files at the end of this topic and save them to your C drive as Accounts.xml and Template.xml (Tip you can just copy and paste the info below)</p>

<p>Building the Workflow</p>

<ol>
  <li>Open Zynk and click on the New Workflow button or choose File &gt; New from the main menu</li>
  <li>You should now see the Task Library pane displayed, Click on the XML Library and then Double-click (or Drag and drop) the XML Repeater to copy that task into the Tasks List</li>
  <li>Set Input File to <code class="highlighter-rouge">C:\accounts.xml</code></li>
  <li>Set XPath Query to QueryResult/records this is basically mimics the directory structure of the XML file, the root element being QueryResult and the rows being records elements</li>
  <li>Next, locate the Razor Template task in the Zynk library and you need to drag it and drop it <em>on top</em> of the XML Repeater - donâ€™t worry if you get this wrong, just delete the task and try again.</li>
  <li>Set Output File to <code class="highlighter-rouge">c:\output.txt</code></li>
  <li>Set Prepend Timestamp to True this will prepend the timestamp to each file so the filename is unique,</li>
  <li>Set Template File to <code class="highlighter-rouge">c:\template.txt</code></li>
  <li>Set Timestamp format to <code class="highlighter-rouge">yyyyMMddHHmmssffff</code></li>
  <li>Locate the Zynk Library in the Task Library pane and add the Start Process task to the Task Builder</li>
  <li>Click on the Save button and enter the name Tutorial 2 for the name of the Workflow and click OK</li>
  <li>Click on the Run Workflow button</li>
  <li>Look in the My Computer &gt; C drive and you find 3 files have been created <code class="highlighter-rouge">namedyyyyMMddHHmmssffff\output.txt</code></li>
  <li>Congratulations you have just completed the Advanced workflow tutorial</li>
</ol>

<p>TIP: You can also use a Context variable for the Output File and set the Output File to <code class="highlighter-rouge">c:\output_for_@(Context.Current["Id"]).txt</code> which will create files using the Account Id rather than a random timestamp, ensure when you do this you tick the box to tell Zynk to render the Output File through the Razor engine.</p>

<p>Accounts.xml - Save to your C drive</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;QueryResult&gt;</span>
	<span class="nt">&lt;records</span> <span class="na">type=</span><span class="s">"Account"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;Id&gt;</span>0014000000LfPszAAF<span class="nt">&lt;/Id&gt;</span>
		<span class="nt">&lt;Name&gt;</span>Sian Jones<span class="nt">&lt;/Name&gt;</span>
	<span class="nt">&lt;/records&gt;</span>
	<span class="nt">&lt;records</span> <span class="na">type=</span><span class="s">"Account"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;Id&gt;</span>0014000000HuWNqAAN<span class="nt">&lt;/Id&gt;</span>
		<span class="nt">&lt;Name&gt;</span>Jeans Point Limited<span class="nt">&lt;/Name&gt;</span>
	<span class="nt">&lt;/records&gt;</span>
	<span class="nt">&lt;records</span> <span class="na">type=</span><span class="s">"Account"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;Id&gt;</span>0014000000HuWNtAAN<span class="nt">&lt;/Id&gt;</span>
		<span class="nt">&lt;Name&gt;</span>Waterside Communications Limited<span class="nt">&lt;/Name&gt;</span>
	<span class="nt">&lt;/records&gt;</span>
<span class="nt">&lt;/QueryResult&gt;</span>
</code></pre>
</div>

<p>Template.txt - Save to your C drive</p>

<pre><code class="language-csv">Dear @Context.Current["Name"]  &lt;br&gt;Thank you for your recent email, we have one of our team looking into the situation now.&lt;br&gt;  For your reference, your Account number is @Context.Current["Id"] Kind Regards,&lt;br&gt;Jennifer Becksworth&lt;br&gt;Office Manager
</code></pre>

                    <hr>
                    <div class="row">
                        <div class="col-sm-6"><a onclick="history.go(-1)" href="#"><span class="fa fa-arrow-left"></span>Back</a></div>
                        <div class="col-sm-6 text-right"><a href="http://github.com/Zynk-workflow/docs/tree/master/_documentation/Getting-Started-Section/Using-Data-Repeaters.md"><span class="fa fa-github"></span>Edit on Github</a></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- /#page-content-wrapper -->
</div>
<!-- /#wrapper -->


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<!-- Menu Toggle Script -->
<script>
    $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/js/bootstrap.min.js"></script>



<script>
    var screenWidth = $(window).width();

    // Add .active class to active link + scroll into view
    var pathinfo = location.pathname + location.hash;
    if (screenWidth > 768 && pathinfo != "/")
    {
        var scrollItem = $("#sidebar-wrapper").find("a[href='" + pathinfo + "']")
                .addClass('active')
                .parents().filter("div>ul>li")[0];
        if (scrollItem) {
            scrollItem.scrollIntoView({
                behavior: "smooth",
                block: "start"
            });
        }
    }

    // Add external link icon next to external menu links
    $(".sidebar-nav a[href^=http]")
        .append('<i class="fa fa-external-link" style="margin-left:-15px"></i>');

    $("#menu-toggle").click(function(){
        $("#sidebar-wrapper").scrollTop(0);
        $(this).toggleClass("fa-angle-down");
        $("#wrapper").toggleClass("menu-collapsed");
    });

    if (screenWidth <= 768) {
        $("#menu-toggle").click();            
    }

    //Allow clicking on non-linked headers to jump to its #href
    $("h2,h3,h4").click(function(){
        if (this.id && this.innerHTML.indexOf("<a") == -1) {
            location.href = "#" + this.id;
        }
    });

    
    
    //should no longer be needed now that we're referencing server-side /slug permalinks
(function () {
    "use strict";
    String.prototype.replaceAll = function(search, replacement) {
        var target = this;
        return target.split(search).join(replacement);
    };

    function fixDoubleBracketLinks(cssSelector) {
        var sidebarText = $(cssSelector)[0].innerHTML;
        var matches = sidebarText.match(/\[\[(.+?)\]\]/g);
        var result = sidebarText;
        if(matches != null) {
            for(var i = 0; i < matches.length; i++) {
                var text = matches[i].replaceAll('[[','').replaceAll(']]','');
                result = result.replace(matches[i],
                    '<a href="' +
                    encodeURIComponent(text.replaceAll(' ','-').toLocaleLowerCase()) +
                    '">' + text + '</a>')
            }
            $(cssSelector).html(result);
        }
    }

    fixDoubleBracketLinks('#page-content-wrapper');
    fixDoubleBracketLinks('#sidebar-wrapper');
})();
    
</script>
    
    
    
</body>
</html>
