<!DOCTYPE html>
<html lang="en">
<head>
    <title>Importing Complex Records to Salesforce</title>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="shortcut icon" type="image/png" href="/images/favicon.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,600,900" rel="stylesheet">
    <link rel="stylesheet" href="css/github.css">
    <link rel="stylesheet" href="css/nav.css">
    <link rel="stylesheet" href="css/sidebar.css">
    <link rel="stylesheet" href="css/style.css">
 </head>
<body>

<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="xcontainer">
        <div class="navbar-header">
            <a class="navbar-brand" title="Go to Zynk.com" href="http://zynk.com"><img class="img-responsive" id="logo-main" src="assets/logo.svg" alt="Click here to visit Zynk.com" /></a>
        </div>
        <div id="myNavbar">
                <ul class="nav navbar-nav navbar-right">
                    <li class="topnav-2"><a href="mailto:support@zynk.com">support@zynk.com</a></li>
                </ul>
        </div>
    </div>
</nav>

<div id="wrapper">

    <!-- Sidebar -->
    <div id="sidebar-wrapper" class="sidebar-nav">
        
        <h1>Zynk Workflow Documentation</h1>
<ul>
  <li><a href="index">Home</a>
    <ul>
      <li>[[Getting Started]]</li>
      <li>[[Key Concepts]]</li>
      <li>[[Using Zynk]]</li>
      <li>[[Settings]]</li>
      <li>[[Extensions]]</li>
      <li>[[Integrations]]</li>
    </ul>
  </li>
  <li>[[Accounting]]
    <ul>
      <li>[[Sage 50 UK]]</li>
      <li>[[Sage 200]]</li>
      <li>[[Sage 200 Online]]</li>
      <li>[[Xero]]</li>
      <li>[[Kashflow]]</li>
      <li>[[Quickbooks Online]]</li>
      <li>[[Sage 50 US]]</li>
      <li>[[Brightpearl]]</li>
      <li>[[Sage One]]</li>
      <li>[[Sage 50 Payroll]]</li>
      <li>[[Sage 50 UK Reporting]]</li>
    </ul>
  </li>
  <li>[[CRM]]
    <ul>
      <li>[[ACT]]</li>
      <li>[[AutoTask]]</li>
      <li>[[BXP]]</li>
      <li>[[Campaign Monitor]]</li>
      <li>[[ConnectWise]]</li>
      <li>[[Salesforce]]</li>
      <li>[[Sugar CRM]]</li>
      <li>[[Zoho CRM]]</li>
    </ul>
  </li>
  <li>[[Databases]]
    <ul>
      <li>[[SQL Server]]</li>
      <li>[[SQLite]]</li>
      <li>[[ODBC]]</li>
      <li>[[OLEDB]]</li>
    </ul>
  </li>
  <li>[[Ecommerce]]
    <ul>
      <li>[[Amazon Marketplace]]</li>
      <li>[[Amazon Vendor Central]]</li>
      <li>[[BigCommerce]]</li>
      <li>[[Channel Advisor]]</li>
      <li>[[CoreCommerce]]</li>
      <li>[[Easy Webstore]]</li>
      <li>[[Ebay]]</li>
      <li>[[EKM Powershop]]</li>
      <li>[[Magento V1]]</li>
      <li>[[Magento V2]]</li>
      <li>[[PayPal]]</li>
      <li>[[Shopify]]</li>
      <li>[[WooCommerce]]</li>
    </ul>
  </li>
  <li>[[Files]]
    <ul>
      <li>[[CSV]]</li>
      <li>[[HTML]]</li>
      <li>[[Excel]]</li>
      <li>[[File]]</li>
      <li>[[File Helpers]]</li>
      <li>[[JSON]]</li>
      <li>[[PDF]]</li>
      <li>[[XML and XSLT]]</li>
    </ul>
  </li>
  <li>[[Cloud]]
    <ul>
      <li>[[Amazon S3]]</li>
    </ul>
  </li>
  <li>[[Social]]
    <ul>
      <li>[[LinkedIn]]</li>
      <li>[[Twitter]]</li>
      <li>[[Facebook]]</li>
    </ul>
  </li>
  <li>[[Web]]
    <ul>
      <li>[[Email]]</li>
      <li>[[FTP]]</li>
      <li>[[SFTP]]</li>
      <li>[[HTTP]]</li>
    </ul>
  </li>
  <li>[[Other]]
    <ul>
      <li>[[Developer]]</li>
      <li>[[SMS]]</li>
      <li>[[User Interface]]</li>
      <li>[[WordPress]]</li>
      <li>[[Zynk Core]]</li>
    </ul>
  </li>
  <li>[[Contact Us]]</li>
</ul>

    </div>
    <!-- /#sidebar-wrapper -->

    <!-- Page Content -->
    <div id="page-content-wrapper">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-12 markdown-body">
                    <a onclick="history.go(-1)" href="#"><span class="fa fa-arrow-left"></span>Back</a>
                    <h1>Importing Complex Records to Salesforce</h1>
                    <p>This task will update or insert multiple records of different types in Salesforce, and create relationships between them. For example, you can use this task to upload opportunities and opportunity item lines, and link them to a particular account and pricebook.</p>

<p>Existing records are matched with those provided in the input file, based on the Salesforce field specified as the key field in the input file. If no key field is specified, the Id will be used for matching. If a match is found, the existing record will be updated, or if no match is found a new record will be inserted.</p>

<p>The task supports performing lookups for the Id of existing records in Salesforce, based on any fields of your choice. For example, if you know the account name when uploading an opportunity, you can use a lookup to set the value of the <code class="highlighter-rouge">AccountId</code> field based on the account name.</p>

<h2 id="settings">Settings</h2>

<h3 id="connection">Connection</h3>
<p><em>Required</em><br />
The Salesforce connection to use, see <a href="connecting-to-salesforce">Connecting to Salesforce</a></p>

<h3 id="fail-file">Fail File</h3>
<p><em>Required</em><br />
The file to output any records to that fail to import to Salesforce.</p>

<h3 id="input-file">Input File</h3>
<p><em>Required</em><br />
The file containing the record to import to Salesforce.</p>

<h3 id="success-file">Success File</h3>
<p><em>Required</em><br />
The file to output successfully imported records to</p>

<h3 id="zynk-settings">Zynk Settings</h3>
<p>See <a href="common-task-settings">Common Task Settings</a></p>

<h2 id="examples">Examples</h2>
<p>A sample input file containing opportunities and item lines is shown below. For detailed information on the XML schema, see <a href="salesforce-complex-object-xml">Salesforce Complex Object XML</a>.</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0"?&gt;</span>
<span class="nt">&lt;SalesforceObjects</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="na">xmlns:xsd=</span><span class="s">"http://www.w3.org/2001/XMLSchema"</span> <span class="na">Type=</span><span class="s">"Opportunity"</span> <span class="na">Key=</span><span class="s">"Name"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;SalesforceObject&gt;</span>
    <span class="nt">&lt;Fields&gt;</span>
      <span class="nt">&lt;Field</span> <span class="na">Name=</span><span class="s">"Name"</span> <span class="na">Value=</span><span class="s">"TEST Opp 12345"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;Field</span> <span class="na">Name=</span><span class="s">"CloseDate"</span> <span class="na">Value=</span><span class="s">"2016-08-10"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;Field</span> <span class="na">Name=</span><span class="s">"StageName"</span> <span class="na">Value=</span><span class="s">"Closed Won"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;LookupField</span> <span class="na">Name=</span><span class="s">"AccountId"</span><span class="nt">&gt;</span> <span class="c">&lt;!-- Lookup the account ID based on name --&gt;</span>
        <span class="nt">&lt;Criteria</span> <span class="na">Type=</span><span class="s">"Account"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;Fields&gt;</span>
            <span class="nt">&lt;Field</span> <span class="na">Name=</span><span class="s">"Name"</span> <span class="na">Value=</span><span class="s">"Test 123"</span> <span class="nt">/&gt;</span>
          <span class="nt">&lt;/Fields&gt;</span>
        <span class="nt">&lt;/Criteria&gt;</span>
      <span class="nt">&lt;/LookupField&gt;</span>
      <span class="nt">&lt;LookupField</span> <span class="na">Name=</span><span class="s">"Pricebook2Id"</span><span class="nt">&gt;</span> <span class="c">&lt;!-- Lookup the pricebook ID based on name --&gt;</span>
        <span class="nt">&lt;Criteria</span> <span class="na">Type=</span><span class="s">"Pricebook2"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;Fields&gt;</span>
            <span class="nt">&lt;Field</span> <span class="na">Name=</span><span class="s">"Name"</span> <span class="na">Value=</span><span class="s">"Standard Price Book"</span> <span class="nt">/&gt;</span>
          <span class="nt">&lt;/Fields&gt;</span>
        <span class="nt">&lt;/Criteria&gt;</span>
      <span class="nt">&lt;/LookupField&gt;</span>
    <span class="nt">&lt;/Fields&gt;</span>
    <span class="nt">&lt;Relationships&gt;</span>
      <span class="nt">&lt;Relationship</span> <span class="na">Type=</span><span class="s">"OpportunityLineItem"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;SalesforceObject&gt;</span>
          <span class="nt">&lt;Fields&gt;</span>
            <span class="nt">&lt;LookupField</span> <span class="na">Name=</span><span class="s">"Id"</span><span class="nt">&gt;</span> <span class="c">&lt;!-- Lookup the Id of existing item lines based on the OpportunityId, and PricebookEntryId --&gt;</span>
              <span class="nt">&lt;Criteria</span> <span class="na">Type=</span><span class="s">"OpportunityLineItem"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;Fields&gt;</span>
                  <span class="nt">&lt;Field</span> <span class="na">Name=</span><span class="s">"OpportunityId"</span> <span class="na">Value=</span><span class="s">"{ParentId}"</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- The opportunity ID is the ID of the parent object --&gt;</span>
                  <span class="nt">&lt;LookupField</span> <span class="na">Name=</span><span class="s">"PricebookEntryId"</span><span class="nt">&gt;</span> <span class="c">&lt;!-- Lookup the PricebookEntryId based on the price book name, currency and product code --&gt;</span>
                    <span class="nt">&lt;Criteria</span> <span class="na">Type=</span><span class="s">"PricebookEntry"</span><span class="nt">&gt;</span>
                      <span class="nt">&lt;Fields&gt;</span>
                        <span class="nt">&lt;Field</span> <span class="na">Name=</span><span class="s">"Pricebook2.Name"</span> <span class="na">Value=</span><span class="s">"Standard Price Book"</span> <span class="nt">/&gt;</span>
                        <span class="nt">&lt;Field</span> <span class="na">Name=</span><span class="s">"CurrencyIsoCode"</span> <span class="na">Value=</span><span class="s">"GBP"</span> <span class="nt">/&gt;</span>
                        <span class="nt">&lt;Field</span> <span class="na">Name=</span><span class="s">"Product2.ProductCode"</span> <span class="na">Value=</span><span class="s">"IPHONE4"</span> <span class="nt">/&gt;</span>
                      <span class="nt">&lt;/Fields&gt;</span>
                    <span class="nt">&lt;/Criteria&gt;</span>
                  <span class="nt">&lt;/LookupField&gt;</span>
                <span class="nt">&lt;/Fields&gt;</span>
              <span class="nt">&lt;/Criteria&gt;</span>
            <span class="nt">&lt;/LookupField&gt;</span>
            <span class="nt">&lt;Field</span> <span class="na">Name=</span><span class="s">"Description"</span> <span class="na">Value=</span><span class="s">"iPhone 4"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;Field</span> <span class="na">Name=</span><span class="s">"OpportunityId"</span> <span class="na">Value=</span><span class="s">"{ParentId}"</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- The opportunity ID is the ID of the parent object --&gt;</span>
            <span class="nt">&lt;Field</span> <span class="na">Name=</span><span class="s">"Quantity"</span> <span class="na">Value=</span><span class="s">"1"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;Field</span> <span class="na">Name=</span><span class="s">"UnitPrice"</span> <span class="na">Value=</span><span class="s">"250"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;LookupField</span> <span class="na">Name=</span><span class="s">"PricebookEntryId"</span><span class="nt">&gt;</span> <span class="c">&lt;!-- Lookup the PricebookEntryId based on the price book name, currency and product code --&gt;</span>
              <span class="nt">&lt;Criteria</span> <span class="na">Type=</span><span class="s">"PricebookEntry"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;Fields&gt;</span>
                  <span class="nt">&lt;Field</span> <span class="na">Name=</span><span class="s">"Pricebook2.Name"</span> <span class="na">Value=</span><span class="s">"Standard Price Book"</span> <span class="nt">/&gt;</span>
                  <span class="nt">&lt;Field</span> <span class="na">Name=</span><span class="s">"CurrencyIsoCode"</span> <span class="na">Value=</span><span class="s">"GBP"</span> <span class="nt">/&gt;</span>
                  <span class="nt">&lt;Field</span> <span class="na">Name=</span><span class="s">"Product2.ProductCode"</span> <span class="na">Value=</span><span class="s">"IPHONE4"</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;/Fields&gt;</span>
              <span class="nt">&lt;/Criteria&gt;</span>
            <span class="nt">&lt;/LookupField&gt;</span>
          <span class="nt">&lt;/Fields&gt;</span>
          <span class="nt">&lt;Relationships</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/SalesforceObject&gt;</span>
      <span class="nt">&lt;/Relationship&gt;</span>
    <span class="nt">&lt;/Relationships&gt;</span>
  <span class="nt">&lt;/SalesforceObject&gt;</span>
<span class="nt">&lt;/SalesforceObjects&gt;</span>
</code></pre>
</div>

                    <hr>
                    <div class="row">
                        <div class="col-sm-6"><a onclick="history.go(-1)" href="#"><span class="fa fa-arrow-left"></span>Back</a></div>
                        <div class="col-sm-6 text-right"><a href="http://github.com/workflow/docs/tree/master/_documentation/Salesforce-Connector/Importing-Complex-Records-to-Salesforce.md"><span class="fa fa-github"></span>Edit on Github</a></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- /#page-content-wrapper -->
</div>
<!-- /#wrapper -->


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<!-- Menu Toggle Script -->
<script>
    $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/js/bootstrap.min.js"></script>



<script>
    var screenWidth = $(window).width();

    // Add .active class to active link + scroll into view
    var pathinfo = location.pathname + location.hash;
    if (screenWidth > 768 && pathinfo != "/")
    {
        var scrollItem = $("#sidebar-wrapper").find("a[href='" + pathinfo + "']")
                .addClass('active')
                .parents().filter("div>ul>li")[0];
        if (scrollItem) {
            scrollItem.scrollIntoView({
                behavior: "smooth",
                block: "start"
            });
        }
    }

    // Add external link icon next to external menu links
    $(".sidebar-nav a[href^=http]")
        .append('<i class="fa fa-external-link" style="margin-left:-15px"></i>');

    $("#menu-toggle").click(function(){
        $("#sidebar-wrapper").scrollTop(0);
        $(this).toggleClass("fa-angle-down");
        $("#wrapper").toggleClass("menu-collapsed");
    });

    if (screenWidth <= 768) {
        $("#menu-toggle").click();            
    }

    //Allow clicking on non-linked headers to jump to its #href
    $("h2,h3,h4").click(function(){
        if (this.id && this.innerHTML.indexOf("<a") == -1) {
            location.href = "#" + this.id;
        }
    });

    
    
    //should no longer be needed now that we're referencing server-side /slug permalinks
(function () {
    "use strict";
    String.prototype.replaceAll = function(search, replacement) {
        var target = this;
        return target.split(search).join(replacement);
    };

    function fixDoubleBracketLinks(cssSelector) {
        var sidebarText = $(cssSelector)[0].innerHTML;
        var matches = sidebarText.match(/\[\[(.+?)\]\]/g);
        var result = sidebarText;
        if(matches != null) {
            for(var i = 0; i < matches.length; i++) {
                var text = matches[i].replaceAll('[[','').replaceAll(']]','');
                result = result.replace(matches[i],
                    '<a href="' +
                    encodeURIComponent(text.replaceAll(' ','-').toLocaleLowerCase()) +
                    '">' + text + '</a>')
            }
            $(cssSelector).html(result);
        }
    }

    fixDoubleBracketLinks('#page-content-wrapper');
    fixDoubleBracketLinks('#sidebar-wrapper');
})();
    
</script>
    
    
    
</body>
</html>
