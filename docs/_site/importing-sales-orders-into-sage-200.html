<!DOCTYPE html>
<html lang="en">
<head>
    <title>Importing Sales Orders into Sage 200</title>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="shortcut icon" type="image/png" href="/images/favicon.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,600,900" rel="stylesheet">
    <link rel="stylesheet" href="css/github.css">
    <link rel="stylesheet" href="css/nav.css">
    <link rel="stylesheet" href="css/sidebar.css">
    <link rel="stylesheet" href="css/style.css">
 </head>
<body>

<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="xcontainer">
        <div class="navbar-header">
            <a class="navbar-brand" title="Go to Zynk.com" href="http://zynk.com"><img class="img-responsive" id="logo-main" src="assets/logo.svg" alt="Click here to visit Zynk.com" /></a>
        </div>
        <div id="myNavbar">
                <ul class="nav navbar-nav navbar-right">
                    <li class="topnav-2"><a href="mailto:support@zynk.com">support@zynk.com</a></li>
                </ul>
        </div>
    </div>
</nav>

<div id="wrapper">

    <!-- Sidebar -->
    <div id="sidebar-wrapper" class="sidebar-nav">
        
        <h1>Zynk Workflow Documentation</h1>
<ul>
  <li><a href="index">Home</a></li>
  <li>[[Introduction]]
    <ul>
      <li>[[Welcome]]</li>
      <li>[[Getting Started]]</li>
      <li>[[Key Concepts]]</li>
      <li>[[Using Zynk]]</li>
      <li>[[Settings]]</li>
      <li>[[Extensions]]</li>
      <li>[[Integrations]]</li>
    </ul>
  </li>
  <li>[[Accounting]]
    <ul>
      <li>[[Sage 50 UK]]</li>
      <li>[[Sage 200]]</li>
      <li>[[Sage 200 Online]]</li>
      <li>[[Xero]]</li>
      <li>[[Kashflow]]</li>
      <li>[[Quickbooks Online]]</li>
      <li>[[Sage 50 US]]</li>
      <li>[[Brightpearl]]</li>
      <li>[[Sage One]]</li>
      <li>[[Sage 50 Payroll]]</li>
      <li>[[Sage 50 UK Reporting]]</li>
    </ul>
  </li>
  <li>[[CRM]]
    <ul>
      <li>[[ACT]]</li>
      <li>[[AutoTask]]</li>
      <li>[[BXP]]</li>
      <li>[[Campaign Monitor]]</li>
      <li>[[ConnectWise]]</li>
      <li>[[Salesforce]]</li>
      <li>[[Sugar CRM]]</li>
      <li>[[Zoho CRM]]</li>
    </ul>
  </li>
  <li>[[Databases]]
    <ul>
      <li>[[SQL Server]]</li>
      <li>[[SQLite]]</li>
      <li>[[ODBC]]</li>
      <li>[[OLEDB]]</li>
    </ul>
  </li>
  <li>[[Ecommerce]]
    <ul>
      <li>[[Amazon Marketplace]]</li>
      <li>[[Amazon Vendor Central]]</li>
      <li>[[BigCommerce]]</li>
      <li>[[Channel Advisor]]</li>
      <li>[[CoreCommerce]]</li>
      <li>[[Easy Webstore]]</li>
      <li>[[Ebay]]</li>
      <li>[[EKM Powershop]]</li>
      <li>[[Magento V1]]</li>
      <li>[[Magento V2]]</li>
      <li>[[PayPal]]</li>
      <li>[[Shopify]]</li>
      <li>[[WooCommerce]]</li>
    </ul>
  </li>
  <li>[[Files]]
    <ul>
      <li>[[CSV]]</li>
      <li>[[HTML]]</li>
      <li>[[Excel]]</li>
      <li>[[File]]</li>
      <li>[[File Helpers]]</li>
      <li>[[JSON]]</li>
      <li>[[PDF]]</li>
      <li>[[XML and XSLT]]</li>
    </ul>
  </li>
  <li>[[Cloud]]
    <ul>
      <li>[[Amazon S3]]</li>
    </ul>
  </li>
  <li>[[Social]]
    <ul>
      <li>[[LinkedIn]]</li>
      <li>[[Twitter]]</li>
      <li>[[Facebook]]</li>
    </ul>
  </li>
  <li>[[Web]]
    <ul>
      <li>[[Email]]</li>
      <li>[[FTP]]</li>
      <li>[[SFTP]]</li>
      <li>[[HTTP]]</li>
    </ul>
  </li>
  <li>[[Other]]
    <ul>
      <li>[[Developer]]</li>
      <li>[[SMS]]</li>
      <li>[[User Interface]]</li>
      <li>[[WordPress]]</li>
      <li>[[Zynk Core]]</li>
    </ul>
  </li>
  <li>[[Contact Us]]</li>
</ul>

    </div>
    <!-- /#sidebar-wrapper -->

    <!-- Page Content -->
    <div id="page-content-wrapper">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-12 markdown-body">
                    <a onclick="history.go(-1)" href="#"><span class="fa fa-arrow-left"></span>Back</a>
                    <h1>Importing Sales Orders into Sage 200</h1>
                    <p>This task will import new Sales Orders into Sage 200 from an XML file formatted in Zynk XML format.</p>

<h2 id="settings">Settings</h2>
<h3 id="sage-200-connection">Sage 200 Connection</h3>
<p><em>Required</em><br />
The Sage 200 connection to use.  See the <a href="connecting-to-sage-200">Connecting to Sage 200</a> article if you require more information on how to create/manage connections</p>

<h3 id="match-accounts-on">Match Accounts On</h3>
<p><em>Optional</em><br />
The settings to use to match customer accounts when an account reference is not provided in the input file.</p>

<h3 id="input-file">Input File</h3>
<p><em>Required</em><br />
The source file for importing in Zynk XML format.</p>

<h3 id="fail-file">Fail File</h3>
<p><em>Required</em><br />
The name of the file to store failed sales orders in Zynk XML format.</p>

<h3 id="success-file">Success File</h3>
<p><em>Required</em><br />
The name of the file to store the successfully imported sales orders in Zynk XML format.</p>

<h3 id="auto-acknowledge-order">Auto Acknowledge Order</h3>
<p><em>Required</em><br />
Will automatically mark the order as acknowledged on saving the Sales Order.</p>

<h3 id="auto-despatch-order">Auto Despatch Order</h3>
<p><em>Required</em><br />
Will automatically mark the order as despatched on saving the Sales Order.</p>

<h3 id="auto-post-invoice">Auto Post Invoice</h3>
<p><em>Required</em><br />
Will automatically post the invoice on saving the Sales Order.</p>

<h3 id="auto-print-order-invoice">Auto Print Order Invoice</h3>
<p><em>Required</em><br />
Will automatically print the order invoice on saving the Sales Order.</p>

<h3 id="auto-print-picking-list">Auto Print Picking List</h3>
<p><em>Required</em><br />
Choose whether picking lists should be printed. The following options are available:</p>

<ul>
  <li><strong>Disabled</strong> - Picking lists are never printed.</li>
  <li><strong>AsSage</strong> - Picking lists will be printed if enabled in Sage under SOP Settings &gt; Automatically print picking list as part of order entry allocation.</li>
  <li><strong>Always</strong> - Picking lists will be printed regardless of the settings in Sage.</li>
</ul>

<h3 id="invoice-payments">Invoice Payments</h3>
<p><em>Required</em><br />
Will automatically invoice payments on saving the Sales Order.</p>

<h3 id="validate-delivery-dates">Validate Delivery Dates</h3>
<p><em>Required</em><br />
Set to true to validate the RequestedDeliveryDate and PromisedDeliveryDate provided in the input file. Validation will fail if either of these dates is in the past. Set to false to import the orders even if the delivery dates are in the past.</p>

<h3 id="credit-check-limit">Credit Check Limit</h3>
<p><em>Required</em><br />
If accepting the order will place the account over their credit limit the order will be placed on hold.</p>

<h3 id="manual-order-number">Manual Order Number</h3>
<p><em>Required</em><br />
Specifies if the sales order number specified in the XML should be used or if Sage 200 should allocate the order numbers.</p>

<h3 id="ready-for-invoice-printing">Ready for Invoice Printing</h3>
<p><em>Required</em><br />
If set to true marks the order as ready for invoice printing.</p>

<h3 id="vat-settings">VAT Settings</h3>
<p><em>Optional</em><br />
Configure custom VAT settings to use when importing the orders.</p>

<h3 id="auto-allocate-stock">Auto Allocate Stock</h3>
<p><em>Required</em><br />
Choose whether to allocate stock to the sales orders. The following options are available:</p>

<ul>
  <li><strong>Disabled</strong> - Stock will not be allocated to the sales order, even when ‘Allocate stock on order entry’ is enabled in the SOP settings.</li>
  <li><strong>AsSage</strong> - Stock will be allocated if ‘Allocate stock on order entry’ is enabled in the SOP settings.</li>
  <li><strong>Always</strong> - Stock will be allocated to the sales order, even when ‘Allocate stock on order entry’ is disabled in the SOP settings</li>
</ul>

<h3 id="auto-create-products">Auto Create Products</h3>
<p><em>Required</em><br />
Will automatically create products if they do not exist in Sage 200.</p>

<h3 id="default-carriage-sku">Default Carriage SKU</h3>
<p><em>Required</em><br />
Allows you to specify a default stock code for carriage line.</p>

<h3 id="default-category">Default Category</h3>
<p><em>Required</em><br />
Allows you to specify a default category for newly created items.</p>

<h3 id="default-warehouse">Default Warehouse</h3>
<p><em>Required</em><br />
Allows you to specify the default warehouse to use for newly created products.</p>

<h3 id="product-lookup">Product Lookup</h3>
<p><em>Required</em><br />
Allows you to specify the field to use when searching for products. Acceptable fields are Sku or Barcode.</p>

<h3 id="use-multiple-warehouses">Use Multiple Warehouses</h3>
<p><em>Required</em><br />
Causes the allocation process to allocate from multiple warehouses rather than a single warehouse.</p>

<h3 id="use-sales-trading-warehouse">Use Sales Trading Warehouse</h3>
<p><em>Required</em><br />
Allows you specify only to use Warehouses marked for sales trading.</p>

<h3 id="warehouse-sort-type">Warehouse Sort Type</h3>
<p><em>Required</em><br />
Allows you to override which warehouse to use e.g. Default, Highest Quantity or Lowest Quantity.</p>

<h3 id="zynk-settings">Zynk Settings</h3>
<p>See <a href="common-task-settings">Common Task Settings</a></p>

<h2 id="printing-picking-lists">Printing Picking Lists</h2>
<p>If you have the ‘Auto Print Picking List’ setting enabled on the task, Zynk will automatically print the picking list for the orders imported. In some cases, Zynk will not be able to print picking lists due to the following error: ‘A Linq Data Model named ‘Sage 200 Accounts’ could not be found. Check the Data Model parameter in the connection string, and ensure a model with that name exists in the model repository.’ If this occurs, you will need to copy the following files:</p>

<ul>
  <li>C:\Program Files\Sage200\Unity.config</li>
  <li>C:\Users[<em>your user name</em>]\AppData\Local\Sage\Sage200\AssemblyCache\Sage.Accounting.DataModel.dll</li>
</ul>

<p>into the Zynk install directory (by default this is C:\Program Files\Internetware\Zynk).</p>

<h2 id="examples">Examples</h2>
<p>A sample input file for creating a sales order is shown below. See <a href="sage-200-sales-order-xml">Sage 200 Sales Order XML</a> for more details on the Zynk XML Sales Order format for Sage 200.</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;Company</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="na">xmlns:xsd=</span><span class="s">"http://www.w3.org/2001/XMLSchema"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;SalesOrders&gt;</span>
    <span class="nt">&lt;SalesOrder&gt;</span>
      <span class="nt">&lt;Id&gt;</span>12345<span class="nt">&lt;/Id&gt;</span>
      <span class="nt">&lt;AccountReference&gt;</span>INTE001<span class="nt">&lt;/AccountReference&gt;</span>
      <span class="nt">&lt;SalesOrderDate&gt;</span>2011-01-01T11:11:11<span class="nt">&lt;/SalesOrderDate&gt;</span>
      <span class="nt">&lt;SalesOrderAddress&gt;</span>
        <span class="nt">&lt;Title&gt;</span>Mr<span class="nt">&lt;/Title&gt;</span>
        <span class="nt">&lt;Forename&gt;</span>Test<span class="nt">&lt;/Forename&gt;</span>
        <span class="nt">&lt;Surname&gt;</span>Person<span class="nt">&lt;/Surname&gt;</span>
        <span class="nt">&lt;Company&gt;</span>Zynk Software<span class="nt">&lt;/Company&gt;</span>
        <span class="nt">&lt;Address1&gt;</span>Nelson House<span class="nt">&lt;/Address1&gt;</span>
        <span class="nt">&lt;Address2&gt;</span>Fleming Business Centre<span class="nt">&lt;/Address2&gt;</span>
        <span class="nt">&lt;Address3&gt;</span>Jesmond<span class="nt">&lt;/Address3&gt;</span>
        <span class="nt">&lt;Town&gt;</span>Newcastle Upon Tyne<span class="nt">&lt;/Town&gt;</span>
        <span class="nt">&lt;Postcode&gt;</span>NE2 3AE<span class="nt">&lt;/Postcode&gt;</span>
        <span class="nt">&lt;County&gt;</span>Tyne <span class="ni">&amp;amp;</span> Wear<span class="nt">&lt;/County&gt;</span>
        <span class="nt">&lt;Country&gt;</span>GB<span class="nt">&lt;/Country&gt;</span>
      <span class="nt">&lt;/SalesOrderAddress&gt;</span>
      <span class="nt">&lt;SalesOrderDeliveryAddress&gt;</span>
        <span class="nt">&lt;Title&gt;</span>Mr<span class="nt">&lt;/Title&gt;</span>
        <span class="nt">&lt;Forename&gt;</span>Test<span class="nt">&lt;/Forename&gt;</span>
        <span class="nt">&lt;Surname&gt;</span>Person<span class="nt">&lt;/Surname&gt;</span>
        <span class="nt">&lt;Company&gt;</span>Zynk Software<span class="nt">&lt;/Company&gt;</span>
        <span class="nt">&lt;Address1&gt;</span>Nelson House<span class="nt">&lt;/Address1&gt;</span>
        <span class="nt">&lt;Address2&gt;</span>Fleming Business Centre<span class="nt">&lt;/Address2&gt;</span>
        <span class="nt">&lt;Address3&gt;</span>Jesmond<span class="nt">&lt;/Address3&gt;</span>
        <span class="nt">&lt;Town&gt;</span>Newcastle Upon Tyne<span class="nt">&lt;/Town&gt;</span>
        <span class="nt">&lt;Postcode&gt;</span>NE2 3AE<span class="nt">&lt;/Postcode&gt;</span>
        <span class="nt">&lt;County&gt;</span>Tyne <span class="ni">&amp;amp;</span> Wear<span class="nt">&lt;/County&gt;</span>
        <span class="nt">&lt;Country&gt;</span>GB<span class="nt">&lt;/Country&gt;</span>
      <span class="nt">&lt;/SalesOrderDeliveryAddress&gt;</span>
      <span class="nt">&lt;SalesOrderItems&gt;</span>
        <span class="nt">&lt;Item&gt;</span>
          <span class="nt">&lt;Sku&gt;</span>TEST01<span class="nt">&lt;/Sku&gt;</span>
          <span class="nt">&lt;QtyOrdered&gt;</span>1<span class="nt">&lt;/QtyOrdered&gt;</span>
          <span class="nt">&lt;UnitPrice&gt;</span>200<span class="nt">&lt;/UnitPrice&gt;</span>
        <span class="nt">&lt;/Item&gt;</span>
      <span class="nt">&lt;/SalesOrderItems&gt;</span>
    <span class="nt">&lt;/SalesOrder&gt;</span>
  <span class="nt">&lt;/SalesOrders&gt;</span>
<span class="nt">&lt;/Company&gt;</span>
</code></pre>
</div>

                    <hr>
                    <div class="row">
                        <div class="col-sm-6"><a onclick="history.go(-1)" href="#"><span class="fa fa-arrow-left"></span>Back</a></div>
                        <div class="col-sm-6 text-right"><a href="http://github.com/Zynk-workflow/docs/tree/master/_documentation/Sage-200-Connector/Importing-Sales-Orders-into-Sage-200.md"><span class="fa fa-github"></span>Edit on Github</a></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- /#page-content-wrapper -->
</div>
<!-- /#wrapper -->


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<!-- Menu Toggle Script -->
<script>
    $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/js/bootstrap.min.js"></script>



<script>
    var screenWidth = $(window).width();

    // Add .active class to active link + scroll into view
    var pathinfo = location.pathname + location.hash;
    if (screenWidth > 768 && pathinfo != "/")
    {
        var scrollItem = $("#sidebar-wrapper").find("a[href='" + pathinfo + "']")
                .addClass('active')
                .parents().filter("div>ul>li")[0];
        if (scrollItem) {
            scrollItem.scrollIntoView({
                behavior: "smooth",
                block: "start"
            });
        }
    }

    // Add external link icon next to external menu links
    $(".sidebar-nav a[href^=http]")
        .append('<i class="fa fa-external-link" style="margin-left:-15px"></i>');

    $("#menu-toggle").click(function(){
        $("#sidebar-wrapper").scrollTop(0);
        $(this).toggleClass("fa-angle-down");
        $("#wrapper").toggleClass("menu-collapsed");
    });

    if (screenWidth <= 768) {
        $("#menu-toggle").click();            
    }

    //Allow clicking on non-linked headers to jump to its #href
    $("h2,h3,h4").click(function(){
        if (this.id && this.innerHTML.indexOf("<a") == -1) {
            location.href = "#" + this.id;
        }
    });

    
    
    //should no longer be needed now that we're referencing server-side /slug permalinks
(function () {
    "use strict";
    String.prototype.replaceAll = function(search, replacement) {
        var target = this;
        return target.split(search).join(replacement);
    };

    function fixDoubleBracketLinks(cssSelector) {
        var sidebarText = $(cssSelector)[0].innerHTML;
        var matches = sidebarText.match(/\[\[(.+?)\]\]/g);
        var result = sidebarText;
        if(matches != null) {
            for(var i = 0; i < matches.length; i++) {
                var text = matches[i].replaceAll('[[','').replaceAll(']]','');
                result = result.replace(matches[i],
                    '<a href="' +
                    encodeURIComponent(text.replaceAll(' ','-').toLocaleLowerCase()) +
                    '">' + text + '</a>')
            }
            $(cssSelector).html(result);
        }
    }

    fixDoubleBracketLinks('#page-content-wrapper');
    fixDoubleBracketLinks('#sidebar-wrapper');
})();
    
</script>
    
    
    
</body>
</html>
